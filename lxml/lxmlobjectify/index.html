
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../lxmlfaq/">
      
      
        <link rel="next" href="../extendlxml/element_classes/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>lxml.objectify - ECMA-376标准中文版(部分)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bd3936ea.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lxmlobjectify" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
你当前浏览的版本已不是最新版本，
<a href="../../..">
    <strong>点击这里</strong>
</a>查看最新版本的文档

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="ECMA-376标准中文版(部分)" class="md-header__button md-logo" aria-label="ECMA-376标准中文版(部分)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ECMA-376标准中文版(部分)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              lxml.objectify
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
    
  
  概述

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ecma-part1/" class="md-tabs__link">
          
  
    
  
  Part1(2016)

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../ecma-part2-refrence/" class="md-tabs__link">
        
  
    
  
  Part2(2016)

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../ecma-part3-refrence/" class="md-tabs__link">
        
  
    
  
  Part3(2015)

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../xsd/old/xmlSchema/pml/" class="md-tabs__link">
          
  
    
  
  xsd

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../xsd/new/xmlSchema/pml/" class="md-tabs__link">
          
  
    
  
  xsd(新版本)

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../other/xsd-parse/" class="md-tabs__link">
          
  
    
  
  其他资料

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ECMA-376标准中文版(部分)" class="md-nav__button md-logo" aria-label="ECMA-376标准中文版(部分)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ECMA-376标准中文版(部分)
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
      
        
          
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    概述
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            概述
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../ecma-part1/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Part1(2016)
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Part1(2016)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. 适用范围
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. 一致性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. 规范性参考文献
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. 术语和定义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. 符号约定
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. 缩略语
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. 一般说明
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8. 概述
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9. 包
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10. 标记兼容性和可扩展性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11. WordprocessingML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12. SpreadsheetML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    13. PresentationML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    14. DrawingML
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    15. Shared
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    16. 部件概览
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-17/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    17. WordprocessingML 参考资料
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-18/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    18. SpareadsheetML 参考资料
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../ecma-part1/chapter19/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    19. PresentationML 参考资料
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../ecma-part1/chapter20/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    20. DrawingML - 框架参考资料
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../ecma-part1/chapter21/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    21. DrawingML - 组件参考资料
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../ecma-part1/chapter22/math/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    22. Shared MLs 参考资料
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/chapter-23/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    23. Custom XML Schema 参考资料
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-a/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录A:Schemas - W3C XML Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-b/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录B:Schemas - RELAX NG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-c/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录C:附加语法约束
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录D:示例中的命名空间前缀映射
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-e/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录E:WordprocessingML 自定义 XML 数据提取
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-f/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录F:WordprocessingML 页面边框
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-g/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录G:预定义的 SpreadsheetML 样式定义
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-h/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录H:预定义 DrawingML 形状和文本几何形状示例
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-i/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录I:双向支持
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-j/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录J:无障碍最佳实践
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-k/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录K:根元素位置
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../ecma-part1/annexL/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    附录L:入门读物
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/annex-m/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    附录M:ECMA-376:2016 和 ECMA-376:2006 之间的差异
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part1/bibliography/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    参考文献
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part2-refrence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part2(2016)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../ecma-part3-refrence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part3(2015)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    xsd
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            xsd
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../xsd/old/xmlSchema/pml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pml.xsd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../xsd/old/xmlSchema/sml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sml.xsd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../xsd/old/xmlSchema/wml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wml.xsd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../xsd/new/opc/opc-contentTypes/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    opc
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../xsd/old/xmlSchema/dml-chart/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    dml
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../xsd/old/xmlSchema/shared-additionalCharacteristics/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    shared
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  <span class="md-ellipsis">
    xsd(新版本)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            xsd(新版本)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../xsd/new/xmlSchema/pml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pml.xsd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../xsd/new/xmlSchema/sml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sml.xsd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../xsd/new/xmlSchema/wml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wml.xsd
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../xsd/new/opc/opc-contentTypes/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    opc
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../xsd/new/xmlSchema/dml-chart/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    dml
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../xsd/new/xmlSchema/shared-additionalCharacteristics/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    shared
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    其他资料
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            其他资料
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../other/xsd-parse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    解析XSD文件
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" checked>
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    lxml库
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            lxml库
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../lxml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lxml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../whylxml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    为何选择lxml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../installinglxml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    安装lxml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarksandspeed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    基准和速度
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../elementtreecompatibilityoflxmletree/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lxml.tree 与 ElementTree 的兼容性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../lxmlfaq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lxml 常见问题解答
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7_2_7" id="__nav_7_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    利用lxml进行开发
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_2_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7_2_7">
            <span class="md-nav__icon md-icon"></span>
            利用lxml进行开发
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    lxml.objectify
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    lxml.objectify
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lxmlobjectify-api接口" class="md-nav__link">
    lxml.objectify API接口
  </a>
  
    <nav class="md-nav" aria-label="lxml.objectify API接口">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#通过对象属性访问元素" class="md-nav__link">
    通过对象属性访问元素
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#创建对象树" class="md-nav__link">
    创建对象树
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#使用-e-factory-生成节点树" class="md-nav__link">
    使用 E-factory 生成节点树
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#命名空间处理" class="md-nav__link">
    命名空间处理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#断言schema" class="md-nav__link">
    断言Schema
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objectpath" class="md-nav__link">
    ObjectPath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python数据类型" class="md-nav__link">
    Python数据类型
  </a>
  
    <nav class="md-nav" aria-label="Python数据类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#递归数并表示" class="md-nav__link">
    递归数并表示
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#元素的递归字符串表示" class="md-nav__link">
    元素的递归字符串表示
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#如何匹配数据类型" class="md-nav__link">
    如何匹配数据类型
  </a>
  
    <nav class="md-nav" aria-label="如何匹配数据类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#类型注解" class="md-nav__link">
    类型注解
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xml-schema的数据类型注释" class="md-nav__link">
    XML Schema的数据类型注释
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataelement-工厂" class="md-nav__link">
    DataElement 工厂
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#定义附加数据类" class="md-nav__link">
    定义附加数据类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#高级元素类查找" class="md-nav__link">
    高级元素类查找
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#与-lxmletree-有什么不同" class="md-nav__link">
    与 lxml.etree 有什么不同？
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../extendlxml/element_classes/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    扩展lxml
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../struct/theme/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    文档树形结构
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lxmlobjectify-api接口" class="md-nav__link">
    lxml.objectify API接口
  </a>
  
    <nav class="md-nav" aria-label="lxml.objectify API接口">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#通过对象属性访问元素" class="md-nav__link">
    通过对象属性访问元素
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#创建对象树" class="md-nav__link">
    创建对象树
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#使用-e-factory-生成节点树" class="md-nav__link">
    使用 E-factory 生成节点树
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#命名空间处理" class="md-nav__link">
    命名空间处理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#断言schema" class="md-nav__link">
    断言Schema
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objectpath" class="md-nav__link">
    ObjectPath
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python数据类型" class="md-nav__link">
    Python数据类型
  </a>
  
    <nav class="md-nav" aria-label="Python数据类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#递归数并表示" class="md-nav__link">
    递归数并表示
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#元素的递归字符串表示" class="md-nav__link">
    元素的递归字符串表示
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#如何匹配数据类型" class="md-nav__link">
    如何匹配数据类型
  </a>
  
    <nav class="md-nav" aria-label="如何匹配数据类型">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#类型注解" class="md-nav__link">
    类型注解
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xml-schema的数据类型注释" class="md-nav__link">
    XML Schema的数据类型注释
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataelement-工厂" class="md-nav__link">
    DataElement 工厂
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#定义附加数据类" class="md-nav__link">
    定义附加数据类
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#高级元素类查找" class="md-nav__link">
    高级元素类查找
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#与-lxmletree-有什么不同" class="md-nav__link">
    与 lxml.etree 有什么不同？
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="lxmlobjectify">lxml.objectify<a class="headerlink" href="#lxmlobjectify" title="Permanent link">&para;</a></h1>
<ul>
<li>原文: <a href="https://lxml.de/objectify.html">https://lxml.de/objectify.html</a></li>
<li>lxml.objectify API: <a href="https://lxml.de/apidoc/lxml.objectify.html">https://lxml.de/apidoc/lxml.objectify.html</a></li>
<li>xml schema - wiki:<ul>
<li>xsd(xml schema definition): <a href="https://zh.wikipedia.org/wiki/XML_Schema">https://zh.wikipedia.org/wiki/XML_Schema</a></li>
<li>xsd schema language: <a href="https://zh.wikipedia.org/wiki/XML_Schema语言">https://zh.wikipedia.org/wiki/XML_Schema语言</a></li>
</ul>
</li>
<li>xml schema - w3school: <a href="https://www.w3school.com.cn/schema/index.asp">https://www.w3school.com.cn/schema/index.asp</a></li>
<li>xmlschema - github: <a href="https://github.com/sissaschool/xmlschema">https://github.com/sissaschool/xmlschema</a></li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">中文</label><label for="__tabbed_1_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<dl>
<dt><strong>作者</strong></dt>
<dd>
<p>Stefan Behnel</p>
</dd>
<dd>
<p>Holger Joukl</p>
</dd>
</dl>
<p>lxml 通过自定义 Element 实现支持类似于 <a href="http://uche.ogbuji.net/tech/4suite/amara/"><strong>Amara</strong></a> 绑定库或 <a href="http://uche.ogbuji.net/tech/4suite/amara/"><strong>gnosis.xml.objectify</strong></a> 的替代 API。 主要思想是将 XML 的使用隐藏在普通 Python 对象后面，有时称为数据绑定。 它允许您像处理普通的 Python 对象层次结构一样使用 XML。</p>
<p>访问 XML 元素的子元素会部署对象属性访问。 如果有多个同名的子元素，可以使用切片和索引。 Python 数据类型会自动从 XML 内容中提取，并可供普通 Python 操作员使用。</p>
<p>要设置和使用 objectify，您需要 <code>lxml.etree</code> 模块和 <code>lxml.objectify</code>：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">lxml</span> <span style="color: #008000; font-weight: bold">import</span> etree
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">lxml</span> <span style="color: #008000; font-weight: bold">import</span> objectify
</code></pre></div>
</div>
<div class="tabbed-block">
<dl>
<dt><strong>Authors</strong></dt>
<dd>
<p>Stefan Behnel</p>
</dd>
<dd>
<p>Holger Joukl</p>
</dd>
</dl>
<p>lxml supports an alternative API similar to the <a href="http://uche.ogbuji.net/tech/4suite/amara/"><strong>Amara</strong></a> bindery or <a href="http://gnosis.cx/download/"><strong>gnosis.xml.objectify</strong></a> through a custom Element implementation. The main idea is to hide the usage of XML behind normal Python objects, sometimes referred to as data-binding. It allows you to use XML as if you were dealing with a normal Python object hierarchy.</p>
<p>Accessing the children of an XML element deploys object attribute access. If there are multiple children with the same name, slicing and indexing can be used. Python data types are extracted from XML content automatically and made available to the normal Python operators.</p>
<p>To set up and use objectify, you need both the lxml.etree module and lxml.objectify:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">lxml</span> <span style="color: #008000; font-weight: bold">import</span> etree
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">lxml</span> <span style="color: #008000; font-weight: bold">import</span> objectify
</code></pre></div>
</div>
</div>
</div>
<h2 id="lxmlobjectify-api接口">lxml.objectify API接口<a class="headerlink" href="#lxmlobjectify-api接口" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">中文</label><label for="__tabbed_2_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>在 <code>lxml.objectify</code> 中，元素树提供了一个 API，它尽可能地模拟普通 Python 对象树的行为。</p>
</div>
<div class="tabbed-block">
<p><strong>The lxml.objectify API</strong></p>
<p>In lxml.objectify, element trees provide an API that models the behaviour of normal Python object trees as closely as possible.</p>
</div>
</div>
</div>
<h3 id="通过对象属性访问元素">通过对象属性访问元素<a class="headerlink" href="#通过对象属性访问元素" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">中文</label><label for="__tabbed_3_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>objectify API 背后的主要思想是将 XML 元素访问隐藏在通常的对象属性访问模式后面。 向元素询问属性将返回具有相应标签名称的子元素序列：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;root&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>b <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;b&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">b</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>index(root<span style="color: #666666">.</span>b[<span style="color: #666666">0</span>])
<span style="color: #717171">0</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>b <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;b&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">b</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b[<span style="color: #666666">1</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">b</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>index(root<span style="color: #666666">.</span>b[<span style="color: #666666">1</span>])
<span style="color: #717171">1</span>
</code></pre></div>
<p>为了方便起见，您可以省略索引<code>0</code>来访问第一个子项：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>tag)
<span style="color: #717171">b</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>index(root<span style="color: #666666">.</span>b)
<span style="color: #717171">0</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">del</span> root<span style="color: #666666">.</span>b
</code></pre></div>
<p>迭代和切片也遵循请求的标签：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>x1 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;x&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>x2 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;x&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>x3 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;x&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>x ]
<span style="color: #717171">[&#39;x&#39;, &#39;x&#39;, &#39;x&#39;]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>x[<span style="color: #666666">1</span>:<span style="color: #666666">3</span>] ]
<span style="color: #717171">[&#39;x&#39;, &#39;x&#39;]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>x[<span style="color: #666666">-1</span>:] ]
<span style="color: #717171">[&#39;x&#39;]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">del</span> root<span style="color: #666666">.</span>x[<span style="color: #666666">1</span>:<span style="color: #666666">2</span>]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>x ]
<span style="color: #717171">[&#39;x&#39;, &#39;x&#39;]</span>
</code></pre></div>
<p>如果您想迭代所有子项或需要为标记提供特定的命名空间，请使用 <code>iterchildren()</code> 方法。 与其他迭代方法一样，它支持可选的标签关键字参数：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>iterchildren() ]
<span style="color: #717171">[&#39;b&#39;, &#39;x&#39;, &#39;x&#39;]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>iterchildren(tag<span style="color: #666666">=</span><span style="color: #BA2121">&#39;b&#39;</span>) ]
<span style="color: #717171">[&#39;b&#39;]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>b ]
<span style="color: #717171">[&#39;b&#39;]</span>
</code></pre></div>
<p>XML 属性的访问方式与普通 <code>ElementTree API</code> 中一样:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>c <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;c&quot;</span>, myattr<span style="color: #666666">=</span><span style="color: #BA2121">&quot;someval&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>c<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;myattr&quot;</span>))
<span style="color: #717171">someval</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>c<span style="color: #666666">.</span>set(<span style="color: #BA2121">&quot;c&quot;</span>, <span style="color: #BA2121">&quot;oh-oh&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>c<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;c&quot;</span>))
<span style="color: #717171">oh-oh</span>
</code></pre></div>
<p>除了用于将元素附加到树的普通 <code>ElementTree API</code> 之外，还可以通过将子树分配给对象属性来添加子树。 在这种情况下，子树会自动深度复制，并更新其根的标记名称以匹配属性名称：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;yet_another_child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>new_child <span style="color: #666666">=</span> el
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>new_child<span style="color: #666666">.</span>tag)
<span style="color: #717171">new_child</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(el<span style="color: #666666">.</span>tag)
<span style="color: #717171">yet_another_child</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>y <span style="color: #666666">=</span> [ objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;y&quot;</span>), objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;y&quot;</span>) ]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>y ]
<span style="color: #717171">[&#39;y&#39;, &#39;y&#39;]</span>
</code></pre></div>
<p>后者是对整个切片进行操作的缩写形式：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>y[:] <span style="color: #666666">=</span> [ objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;y&quot;</span>) ]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>y ]
<span style="color: #717171">[&#39;y&#39;]</span>
</code></pre></div>
<p>你也可以用这种方式替代子元素:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>child1 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>child2 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>child3 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;child&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;new_child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>subel <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(el, <span style="color: #BA2121">&quot;sub&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>child <span style="color: #666666">=</span> el
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>child<span style="color: #666666">.</span>sub<span style="color: #666666">.</span>tag)
<span style="color: #717171">sub</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>child[<span style="color: #666666">2</span>] <span style="color: #666666">=</span> el
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>child[<span style="color: #666666">2</span>]<span style="color: #666666">.</span>sub<span style="color: #666666">.</span>tag)
<span style="color: #717171">sub</span>
</code></pre></div>
<p>请<ins class="critic"> 注意 </ins>，更改元素的标签名称时必须特别小心：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>tag)
<span style="color: #717171">b</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>tag <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;notB&quot;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>b
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: b
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>notB<span style="color: #666666">.</span>tag)
<span style="color: #717171">notB</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Element access through object attributes</strong></p>
<p>The main idea behind the objectify API is to hide XML element access behind the usual object attribute access pattern. Asking an element for an attribute will return the sequence of children with corresponding tag names:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;root&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>b <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;b&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">b</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>index(root<span style="color: #666666">.</span>b[<span style="color: #666666">0</span>])
<span style="color: #717171">0</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>b <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;b&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">b</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b[<span style="color: #666666">1</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">b</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>index(root<span style="color: #666666">.</span>b[<span style="color: #666666">1</span>])
<span style="color: #717171">1</span>
</code></pre></div>
<p>For convenience, you can omit the index '0' to access the first child:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>tag)
<span style="color: #717171">b</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>index(root<span style="color: #666666">.</span>b)
<span style="color: #717171">0</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">del</span> root<span style="color: #666666">.</span>b
</code></pre></div>
<p>Iteration and slicing also obey the requested tag:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>x1 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;x&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>x2 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;x&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>x3 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;x&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>x ]
<span style="color: #717171">[&#39;x&#39;, &#39;x&#39;, &#39;x&#39;]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>x[<span style="color: #666666">1</span>:<span style="color: #666666">3</span>] ]
<span style="color: #717171">[&#39;x&#39;, &#39;x&#39;]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>x[<span style="color: #666666">-1</span>:] ]
<span style="color: #717171">[&#39;x&#39;]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">del</span> root<span style="color: #666666">.</span>x[<span style="color: #666666">1</span>:<span style="color: #666666">2</span>]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>x ]
<span style="color: #717171">[&#39;x&#39;, &#39;x&#39;]</span>
</code></pre></div>
<p>If you want to iterate over all children or need to provide a specific namespace for the tag, use the iterchildren() method. Like the other methods for iteration, it supports an optional tag keyword argument:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>iterchildren() ]
<span style="color: #717171">[&#39;b&#39;, &#39;x&#39;, &#39;x&#39;]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>iterchildren(tag<span style="color: #666666">=</span><span style="color: #BA2121">&#39;b&#39;</span>) ]
<span style="color: #717171">[&#39;b&#39;]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>b ]
<span style="color: #717171">[&#39;b&#39;]</span>
</code></pre></div>
<p>XML attributes are accessed as in the normal ElementTree API:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>c <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;c&quot;</span>, myattr<span style="color: #666666">=</span><span style="color: #BA2121">&quot;someval&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>c<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;myattr&quot;</span>))
<span style="color: #717171">someval</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>c<span style="color: #666666">.</span>set(<span style="color: #BA2121">&quot;c&quot;</span>, <span style="color: #BA2121">&quot;oh-oh&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>c<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;c&quot;</span>))
<span style="color: #717171">oh-oh</span>
</code></pre></div>
<p>In addition to the normal ElementTree API for appending elements to trees, subtrees can also be added by assigning them to object attributes. In this case, the subtree is automatically deep copied and the tag name of its root is updated to match the attribute name:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;yet_another_child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>new_child <span style="color: #666666">=</span> el
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>new_child<span style="color: #666666">.</span>tag)
<span style="color: #717171">new_child</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(el<span style="color: #666666">.</span>tag)
<span style="color: #717171">yet_another_child</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>y <span style="color: #666666">=</span> [ objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;y&quot;</span>), objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;y&quot;</span>) ]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>y ]
<span style="color: #717171">[&#39;y&#39;, &#39;y&#39;]</span>
</code></pre></div>
<p>The latter is a short form for operations on the full slice:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>y[:] <span style="color: #666666">=</span> [ objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;y&quot;</span>) ]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>y ]
<span style="color: #717171">[&#39;y&#39;]</span>
</code></pre></div>
<p>You can also replace children that way:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>child1 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>child2 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>child3 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;child&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;new_child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>subel <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(el, <span style="color: #BA2121">&quot;sub&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>child <span style="color: #666666">=</span> el
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>child<span style="color: #666666">.</span>sub<span style="color: #666666">.</span>tag)
<span style="color: #717171">sub</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>child[<span style="color: #666666">2</span>] <span style="color: #666666">=</span> el
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>child[<span style="color: #666666">2</span>]<span style="color: #666666">.</span>sub<span style="color: #666666">.</span>tag)
<span style="color: #717171">sub</span>
</code></pre></div>
<p>Note that special care must be taken when changing the tag name of an element:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>tag)
<span style="color: #717171">b</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>tag <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;notB&quot;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>b
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: b
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>notB<span style="color: #666666">.</span>tag)
<span style="color: #717171">notB</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="创建对象树">创建对象树<a class="headerlink" href="#创建对象树" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">中文</label><label for="__tabbed_4_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>与 <code>lxml.etree</code> 一样，您可以通过解析 XML 文档或从头开始构建一棵对象化树来创建对象化树。 要解析文档，只需使用模块的 <a href="https://lxml.de/apidoc/lxml.etree.html#lxml.etree._ElementTree.parse">parse()</a> 或 <a href="https://lxml.de/apidoc/lxml.etree.html#lxml.etree.fromstring">fromstring()</a> 函数：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>fileobject <span style="color: #666666">=</span> StringIO(<span style="color: #BA2121">&#39;&lt;test/&gt;&#39;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>tree <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>parse(fileobject)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">isinstance</span>(tree<span style="color: #666666">.</span>getroot(), objectify<span style="color: #666666">.</span>ObjectifiedElement))
<span style="color: #717171">True</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&lt;test/&gt;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">isinstance</span>(root, objectify<span style="color: #666666">.</span>ObjectifiedElement))
<span style="color: #717171">True</span>
</code></pre></div>
<p>为了在内存中构建新树，objectify 复制了 <code>lxml.etree</code> 中的标准工厂函数 <a href="https://lxml.de/apidoc/lxml.etree.html#lxml.etree.Element">Element()</a>：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>obj_el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;new&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">isinstance</span>(obj_el, objectify<span style="color: #666666">.</span>ObjectifiedElement))
<span style="color: #717171">True</span>
</code></pre></div>
<p>创建这样的元素后，您可以使用 <code>lxml.etree</code> 的常用 API 将子元素添加到树中：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>child <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(obj_el, <span style="color: #BA2121">&quot;newchild&quot;</span>, attr<span style="color: #666666">=</span><span style="color: #BA2121">&quot;value&quot;</span>)
</code></pre></div>
<p>新的子元素将自动从其树继承对象化行为。 但是，您通过 <code>lxml.etree</code> 的 <code>Element()</code> 工厂（而不是 objectify）创建的所有独立元素本身将不支持 objectify API：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>subel <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(obj_el, <span style="color: #BA2121">&quot;sub&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">isinstance</span>(subel, objectify<span style="color: #666666">.</span>ObjectifiedElement))
<span style="color: #717171">True</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>independent_el <span style="color: #666666">=</span> etree<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;new&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">isinstance</span>(independent_el, objectify<span style="color: #666666">.</span>ObjectifiedElement))
<span style="color: #717171">False</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Creating objectify trees</strong></p>
<p>As with lxml.etree, you can either create an objectify tree by parsing an XML document or by building one from scratch. To parse a document, just use the parse() or fromstring() functions of the module:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>fileobject <span style="color: #666666">=</span> StringIO(<span style="color: #BA2121">&#39;&lt;test/&gt;&#39;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>tree <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>parse(fileobject)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">isinstance</span>(tree<span style="color: #666666">.</span>getroot(), objectify<span style="color: #666666">.</span>ObjectifiedElement))
<span style="color: #717171">True</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&lt;test/&gt;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">isinstance</span>(root, objectify<span style="color: #666666">.</span>ObjectifiedElement))
<span style="color: #717171">True</span>
</code></pre></div>
<p>To build a new tree in memory, objectify replicates the standard factory function Element() from lxml.etree:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>obj_el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;new&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">isinstance</span>(obj_el, objectify<span style="color: #666666">.</span>ObjectifiedElement))
<span style="color: #717171">True</span>
</code></pre></div>
<p>After creating such an Element, you can use the usual API of lxml.etree to add SubElements to the tree:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>child <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(obj_el, <span style="color: #BA2121">&quot;newchild&quot;</span>, attr<span style="color: #666666">=</span><span style="color: #BA2121">&quot;value&quot;</span>)
</code></pre></div>
<p>New subelements will automatically inherit the objectify behaviour from their tree. However, all independent elements that you create through the Element() factory of lxml.etree (instead of objectify) will not support the objectify API by themselves:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>subel <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(obj_el, <span style="color: #BA2121">&quot;sub&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">isinstance</span>(subel, objectify<span style="color: #666666">.</span>ObjectifiedElement))
<span style="color: #717171">True</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>independent_el <span style="color: #666666">=</span> etree<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;new&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">isinstance</span>(independent_el, objectify<span style="color: #666666">.</span>ObjectifiedElement))
<span style="color: #717171">False</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="使用-e-factory-生成节点树">使用 E-factory 生成节点树<a class="headerlink" href="#使用-e-factory-生成节点树" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">中文</label><label for="__tabbed_5_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>为了进一步简化树的生成，您可以使用 E-factory：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>E <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>E
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> E<span style="color: #666666">.</span>root(
<span style="color: #000080; font-weight: bold">... </span>  E<span style="color: #666666">.</span>a(<span style="color: #666666">5</span>),
<span style="color: #000080; font-weight: bold">... </span>  E<span style="color: #666666">.</span>b(<span style="color: #666666">6.21</span>),
<span style="color: #000080; font-weight: bold">... </span>  E<span style="color: #666666">.</span>c(<span style="color: #008000; font-weight: bold">True</span>),
<span style="color: #000080; font-weight: bold">... </span>  E<span style="color: #666666">.</span>d(<span style="color: #BA2121">&quot;how&quot;</span>, tell<span style="color: #666666">=</span><span style="color: #BA2121">&quot;me&quot;</span>)
<span style="color: #000080; font-weight: bold">... </span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot;&gt;</span>
<span style="color: #717171">  &lt;a py:pytype=&quot;int&quot;&gt;5&lt;/a&gt;</span>
<span style="color: #717171">  &lt;b py:pytype=&quot;float&quot;&gt;6.21&lt;/b&gt;</span>
<span style="color: #717171">  &lt;c py:pytype=&quot;bool&quot;&gt;true&lt;/c&gt;</span>
<span style="color: #717171">  &lt;d py:pytype=&quot;str&quot; tell=&quot;me&quot;&gt;how&lt;/d&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
<p>这允许您在标签中编写特定语言:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>ROOT <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>E<span style="color: #666666">.</span>root
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>TITLE <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>E<span style="color: #666666">.</span>title
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>HOWMANY <span style="color: #666666">=</span> <span style="color: #008000">getattr</span>(objectify<span style="color: #666666">.</span>E, <span style="color: #BA2121">&quot;how-many&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> ROOT(
<span style="color: #000080; font-weight: bold">... </span>  TITLE(<span style="color: #BA2121">&quot;The title&quot;</span>),
<span style="color: #000080; font-weight: bold">... </span>  HOWMANY(<span style="color: #666666">5</span>)
<span style="color: #000080; font-weight: bold">... </span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot;&gt;</span>
<span style="color: #717171">  &lt;title py:pytype=&quot;str&quot;&gt;The title&lt;/title&gt;</span>
<span style="color: #717171">  &lt;how-many py:pytype=&quot;int&quot;&gt;5&lt;/how-many&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
<p>objectify.E 是 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.ElementMaker">objectify.ElementMaker</a> 的实例。 默认情况下，它创建没有命名空间的 pytype 注释元素。 您可以通过将 <code>False</code> 传递给构造函数的 <code>annotate</code> 关键字参数来关闭 <code>pytype</code> 注释。 您还可以传递默认名称空间和 <code>nsmap</code>：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>myE <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ElementMaker(annotate<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>,
<span style="color: #000080; font-weight: bold">... </span>          namespace<span style="color: #666666">=</span><span style="color: #BA2121">&quot;http://my/ns&quot;</span>, nsmap<span style="color: #666666">=</span>{<span style="color: #008000; font-weight: bold">None</span> : <span style="color: #BA2121">&quot;http://my/ns&quot;</span>})

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> myE<span style="color: #666666">.</span>root( myE<span style="color: #666666">.</span>someint(<span style="color: #666666">2</span>) )

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns=&quot;http://my/ns&quot;&gt;</span>
<span style="color: #717171">  &lt;someint&gt;2&lt;/someint&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Tree generation with the E-factory</strong></p>
<p>To simplify the generation of trees even further, you can use the E-factory:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>E <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>E
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> E<span style="color: #666666">.</span>root(
<span style="color: #000080; font-weight: bold">... </span>  E<span style="color: #666666">.</span>a(<span style="color: #666666">5</span>),
<span style="color: #000080; font-weight: bold">... </span>  E<span style="color: #666666">.</span>b(<span style="color: #666666">6.21</span>),
<span style="color: #000080; font-weight: bold">... </span>  E<span style="color: #666666">.</span>c(<span style="color: #008000; font-weight: bold">True</span>),
<span style="color: #000080; font-weight: bold">... </span>  E<span style="color: #666666">.</span>d(<span style="color: #BA2121">&quot;how&quot;</span>, tell<span style="color: #666666">=</span><span style="color: #BA2121">&quot;me&quot;</span>)
<span style="color: #000080; font-weight: bold">... </span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot;&gt;</span>
<span style="color: #717171">  &lt;a py:pytype=&quot;int&quot;&gt;5&lt;/a&gt;</span>
<span style="color: #717171">  &lt;b py:pytype=&quot;float&quot;&gt;6.21&lt;/b&gt;</span>
<span style="color: #717171">  &lt;c py:pytype=&quot;bool&quot;&gt;true&lt;/c&gt;</span>
<span style="color: #717171">  &lt;d py:pytype=&quot;str&quot; tell=&quot;me&quot;&gt;how&lt;/d&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
<p>This allows you to write up a specific language in tags:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>ROOT <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>E<span style="color: #666666">.</span>root
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>TITLE <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>E<span style="color: #666666">.</span>title
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>HOWMANY <span style="color: #666666">=</span> <span style="color: #008000">getattr</span>(objectify<span style="color: #666666">.</span>E, <span style="color: #BA2121">&quot;how-many&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> ROOT(
<span style="color: #000080; font-weight: bold">... </span>  TITLE(<span style="color: #BA2121">&quot;The title&quot;</span>),
<span style="color: #000080; font-weight: bold">... </span>  HOWMANY(<span style="color: #666666">5</span>)
<span style="color: #000080; font-weight: bold">... </span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot;&gt;</span>
<span style="color: #717171">  &lt;title py:pytype=&quot;str&quot;&gt;The title&lt;/title&gt;</span>
<span style="color: #717171">  &lt;how-many py:pytype=&quot;int&quot;&gt;5&lt;/how-many&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
<p>objectify.E is an instance of objectify.ElementMaker. By default, it creates pytype annotated Elements without a namespace. You can switch off the pytype annotation by passing False to the annotate keyword argument of the constructor. You can also pass a default namespace and an nsmap:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>myE <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ElementMaker(annotate<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>,
<span style="color: #000080; font-weight: bold">... </span>          namespace<span style="color: #666666">=</span><span style="color: #BA2121">&quot;http://my/ns&quot;</span>, nsmap<span style="color: #666666">=</span>{<span style="color: #008000; font-weight: bold">None</span> : <span style="color: #BA2121">&quot;http://my/ns&quot;</span>})

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> myE<span style="color: #666666">.</span>root( myE<span style="color: #666666">.</span>someint(<span style="color: #666666">2</span>) )

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns=&quot;http://my/ns&quot;&gt;</span>
<span style="color: #717171">  &lt;someint&gt;2&lt;/someint&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="命名空间处理">命名空间处理<a class="headerlink" href="#命名空间处理" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">中文</label><label for="__tabbed_6_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>在标签查找期间，名称空间主要在幕后处理。 如果访问 Element 的子元素而不指定命名空间，则查找将使用父元素的命名空间：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;{http://ns/}root&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>b <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://ns/}b&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>c <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://other/}c&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>
</code></pre></div>
<p>请注意，lxml.etree 的 <a href="https://lxml.de/apidoc/lxml.etree.html#lxml.etree.SubElement">SubElement()</a> 工厂在创建新子元素时不会继承任何名称空间。 元素创建必须明确命名空间，并通过如上所述的 E-factory 进行简化。</p>
<p>然而，查找元素时则隐式继承命名空间：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>c)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">    </span><span style="color: #666666">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: {http://ns/}c
</code></pre></div>
<p>要访问与其父级不同的命名空间中的元素，可以使用 <code>getattr()</code>：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>c <span style="color: #666666">=</span> <span style="color: #008000">getattr</span>(root, <span style="color: #BA2121">&quot;{http://other/}c&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(c<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://other/}c</span>
</code></pre></div>
<p>为了方便起见，还有一种快速访问项目的方法：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>c <span style="color: #666666">=</span> root[<span style="color: #BA2121">&quot;{http://other/}c&quot;</span>]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(c<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://other/}c</span>
</code></pre></div>
<p>必须使用相同的方法来访问标签名称不是有效 Python 标识符的子项：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://ns/}tag-name&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}tag-name</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>new_el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;{http://ns/}new-element&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(new_el, <span style="color: #BA2121">&quot;{http://ns/}child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(new_el, <span style="color: #BA2121">&quot;{http://ns/}child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(new_el, <span style="color: #BA2121">&quot;{http://ns/}child&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root[<span style="color: #BA2121">&quot;tag-name&quot;</span>] <span style="color: #666666">=</span> [ new_el, new_el ]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">len</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>]))
<span style="color: #717171">2</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}tag-name</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">len</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>]<span style="color: #666666">.</span>child))
<span style="color: #717171">3</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>]<span style="color: #666666">.</span>child<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}child</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>][<span style="color: #666666">1</span>]<span style="color: #666666">.</span>child<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}child</span>
</code></pre></div>
<p>或者对于 <code>lxml.objectify</code> 中具有特殊含义的名称：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>XML(<span style="color: #BA2121">&quot;&lt;root&gt;&lt;text&gt;TEXT&lt;/text&gt;&lt;/root&gt;&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>text<span style="color: #666666">.</span>text)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: &#39;NoneType&#39; object has no attribute &#39;text&#39;

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root[<span style="color: #BA2121">&quot;text&quot;</span>]<span style="color: #666666">.</span>text)
<span style="color: #717171">TEXT</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Namespace handling</strong></p>
<p>During tag lookups, namespaces are handled mostly behind the scenes. If you access a child of an Element without specifying a namespace, the lookup will use the namespace of the parent:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;{http://ns/}root&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>b <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://ns/}b&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>c <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://other/}c&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>
</code></pre></div>
<p>Note that the SubElement() factory of lxml.etree does not inherit any namespaces when creating a new subelement. Element creation must be explicit about the namespace, and is simplified through the E-factory as described above.</p>
<p>Lookups, however, inherit namespaces implicitly:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>c)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">    </span><span style="color: #666666">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: {http://ns/}c
</code></pre></div>
<p>To access an element in a different namespace than its parent, you can use getattr():</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>c <span style="color: #666666">=</span> <span style="color: #008000">getattr</span>(root, <span style="color: #BA2121">&quot;{http://other/}c&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(c<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://other/}c</span>
</code></pre></div>
<p>For convenience, there is also a quick way through item access:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>c <span style="color: #666666">=</span> root[<span style="color: #BA2121">&quot;{http://other/}c&quot;</span>]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(c<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://other/}c</span>
</code></pre></div>
<p>The same approach must be used to access children with tag names that are not valid Python identifiers:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://ns/}tag-name&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}tag-name</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>new_el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;{http://ns/}new-element&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(new_el, <span style="color: #BA2121">&quot;{http://ns/}child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(new_el, <span style="color: #BA2121">&quot;{http://ns/}child&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(new_el, <span style="color: #BA2121">&quot;{http://ns/}child&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root[<span style="color: #BA2121">&quot;tag-name&quot;</span>] <span style="color: #666666">=</span> [ new_el, new_el ]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">len</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>]))
<span style="color: #717171">2</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}tag-name</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">len</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>]<span style="color: #666666">.</span>child))
<span style="color: #717171">3</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>]<span style="color: #666666">.</span>child<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}child</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root[<span style="color: #BA2121">&quot;tag-name&quot;</span>][<span style="color: #666666">1</span>]<span style="color: #666666">.</span>child<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}child</span>
</code></pre></div>
<p>or for names that have a special meaning in lxml.objectify:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>XML(<span style="color: #BA2121">&quot;&lt;root&gt;&lt;text&gt;TEXT&lt;/text&gt;&lt;/root&gt;&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>text<span style="color: #666666">.</span>text)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: &#39;NoneType&#39; object has no attribute &#39;text&#39;

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root[<span style="color: #BA2121">&quot;text&quot;</span>]<span style="color: #666666">.</span>text)
<span style="color: #717171">TEXT</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="断言schema">断言Schema<a class="headerlink" href="#断言schema" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">中文</label><label for="__tabbed_7_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>当处理来自不同源的 XML 文档时，您通常会要求它们遵循通用的模式。 在 <strong>lxml.objectify</strong> 中，这直接转化为强制执行特定的对象树，即确保预期的对象属性存在并具有预期的类型。 这可以通过解析时的 XML 模式验证轻松实现。 另请参阅有关此主题的<a href="https://lxml.de/validation.html" target="_blank">验证文档</a>。</p>
<p>首先，我们需要一个了解我们的schema的解析器，所以假设我们从类似文件的对象（或文件或文件名）解析schema：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>f <span style="color: #666666">=</span> StringIO(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;xsd:schema xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">    &lt;xsd:element name=&quot;a&quot; type=&quot;AType&quot;/&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">    &lt;xsd:complexType name=&quot;AType&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">      &lt;xsd:sequence&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">        &lt;xsd:element name=&quot;b&quot; type=&quot;xsd:string&quot; /&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">      &lt;/xsd:sequence&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">    &lt;/xsd:complexType&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;/xsd:schema&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>schema <span style="color: #666666">=</span> etree<span style="color: #666666">.</span>XMLSchema(file<span style="color: #666666">=</span>f)
</code></pre></div>
<p>创建验证解析器时，我们必须确保它返回对象化树。 最好使用 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.makeparser">makeparser()</a> 函数来完成：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>parser <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>makeparser(schema <span style="color: #666666">=</span> schema)
</code></pre></div>
<p>现在我们可以用它来解析有效的文档:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xml <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&lt;a&gt;&lt;b&gt;test&lt;/b&gt;&lt;/a&gt;&quot;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>a <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(xml, parser)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(a<span style="color: #666666">.</span>b)
<span style="color: #717171">test</span>
</code></pre></div>
<p>或者无效的文件:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xml <span style="color: #666666">=</span> <span style="color: #BA2121">b&quot;&lt;a&gt;&lt;b&gt;test&lt;/b&gt;&lt;c/&gt;&lt;/a&gt;&quot;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>a <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(xml, parser)  <span style="color: #3D7B7B; font-style: italic"># doctest: +ELLIPSIS</span>
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #E40000">lxml.etree.XMLSyntaxError</span>: Element &#39;c&#39;: This element is not expected...
</code></pre></div>
<p>请注意，这同样适用于解析时 DTD 验证，只是 DTD 在设计上不支持任何数据类型。</p>
</div>
<div class="tabbed-block">
<p><strong>Asserting a Schema</strong></p>
<p>When dealing with XML documents from different sources, you will often require them to follow a common schema. In lxml.objectify, this directly translates to enforcing a specific object tree, i.e. expected object attributes are ensured to be there and to have the expected type. This can easily be achieved through XML Schema validation at parse time. Also see the <a href="https://lxml.de/validation.html">documentation on validation</a> on this topic.</p>
<p>First of all, we need a parser that knows our schema, so let's say we parse the schema from a file-like object (or file or filename):</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>f <span style="color: #666666">=</span> StringIO(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;xsd:schema xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">    &lt;xsd:element name=&quot;a&quot; type=&quot;AType&quot;/&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">    &lt;xsd:complexType name=&quot;AType&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">      &lt;xsd:sequence&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">        &lt;xsd:element name=&quot;b&quot; type=&quot;xsd:string&quot; /&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">      &lt;/xsd:sequence&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">    &lt;/xsd:complexType&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;/xsd:schema&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>schema <span style="color: #666666">=</span> etree<span style="color: #666666">.</span>XMLSchema(file<span style="color: #666666">=</span>f)
</code></pre></div>
<p>When creating the validating parser, we must make sure it returns objectify trees. This is best done with the makeparser() function:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>parser <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>makeparser(schema <span style="color: #666666">=</span> schema)
</code></pre></div>
<p>Now we can use it to parse a valid document:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xml <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;&lt;a&gt;&lt;b&gt;test&lt;/b&gt;&lt;/a&gt;&quot;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>a <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(xml, parser)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(a<span style="color: #666666">.</span>b)
<span style="color: #717171">test</span>
</code></pre></div>
<p>Or an invalid document:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xml <span style="color: #666666">=</span> <span style="color: #BA2121">b&quot;&lt;a&gt;&lt;b&gt;test&lt;/b&gt;&lt;c/&gt;&lt;/a&gt;&quot;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>a <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(xml, parser)  <span style="color: #3D7B7B; font-style: italic"># doctest: +ELLIPSIS</span>
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #E40000">lxml.etree.XMLSyntaxError</span>: Element &#39;c&#39;: This element is not expected...
</code></pre></div>
<p>Note that the same works for parse-time DTD validation, except that DTDs do not support any data types by design.</p>
</div>
</div>
</div>
<h2 id="objectpath">ObjectPath<a class="headerlink" href="#objectpath" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">中文</label><label for="__tabbed_8_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>为了方便和快速，<code>objectify</code> 支持自己的路径语言，由 <code>ObjectPath</code> 类表示：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;{http://ns/}root&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>b1 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://ns/}b&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>c  <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(b1,   <span style="color: #BA2121">&quot;{http://ns/}c&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>b2 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://ns/}b&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>d  <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://other/}d&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.b.c&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(path)
<span style="color: #717171">root.b.c</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>hasattr(root)
<span style="color: #717171">True</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(path<span style="color: #666666">.</span>find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}c</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.b.c&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}c</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.{http://other/}d&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://other/}d</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.</span><span style="color: #A45A77; font-weight: bold">{not}</span><span style="color: #BA2121">there&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: {not}there

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">{not}</span><span style="color: #BA2121">there&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">ValueError</span>: root element does not match: need {not}there, got {http://ns/}root

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.b[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.{http://ns/}b[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>
</code></pre></div>
<p>除了字符串之外，ObjectPath 还接受路径段列表：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath([<span style="color: #BA2121">&#39;root&#39;</span>, <span style="color: #BA2121">&#39;b&#39;</span>, <span style="color: #BA2121">&#39;c&#39;</span>])
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}c</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath([<span style="color: #BA2121">&#39;root&#39;</span>, <span style="color: #BA2121">&#39;{http://ns/}b[1]&#39;</span>])
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>
</code></pre></div>
<p>您还可以使用以<strong>“.”</strong>开头的相对路径忽略实际的根元素并仅继承其名称空间：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.b[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath([<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #BA2121">&#39;b[1]&#39;</span>])
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.unknown[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: {http://ns/}unknown

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.{http://other/}unknown[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: {http://other/}unknown
</code></pre></div>
<p>为了方便起见，单个点代表空的 ObjectPath（标识）：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}root</span>
</code></pre></div>
<p>ObjectPath 对象可用于操作树：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;{http://ns/}root&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.some.child.{http://other/}unknown&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>hasattr(root)
<span style="color: #717171">False</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>find(root)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: {http://ns/}some

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>setattr(root, <span style="color: #BA2121">&quot;my value&quot;</span>) <span style="color: #3D7B7B; font-style: italic"># creates children as necessary</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>hasattr(root)
<span style="color: #717171">True</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(path<span style="color: #666666">.</span>find(root)<span style="color: #666666">.</span>text)
<span style="color: #717171">my value</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>some<span style="color: #666666">.</span>child[<span style="color: #BA2121">&quot;{http://other/}unknown&quot;</span>]<span style="color: #666666">.</span>text)
<span style="color: #717171">my value</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">len</span>( path<span style="color: #666666">.</span>find(root) ))
<span style="color: #717171">1</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>addattr(root, <span style="color: #BA2121">&quot;my new value&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">len</span>( path<span style="color: #666666">.</span>find(root) ))
<span style="color: #717171">2</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>text <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> path<span style="color: #666666">.</span>find(root) ]
<span style="color: #717171">[&#39;my value&#39;, &#39;my new value&#39;]</span>
</code></pre></div>
<p>与属性分配一样，setattr() 接受列表：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>setattr(root, [<span style="color: #BA2121">&quot;v1&quot;</span>, <span style="color: #BA2121">&quot;v2&quot;</span>, <span style="color: #BA2121">&quot;v3&quot;</span>])
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>text <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> path<span style="color: #666666">.</span>find(root) ]
<span style="color: #717171">[&#39;v1&#39;, &#39;v2&#39;, &#39;v3&#39;]</span>
</code></pre></div>
<p>但请注意，仅当子项存在时，此上下文中才支持索引。 对不存在的子项建立索引不会扩展或创建此类子项的列表，但会引发异常：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.</span><span style="color: #A45A77; font-weight: bold">{non}</span><span style="color: #BA2121">existing[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>setattr(root, <span style="color: #BA2121">&quot;my value&quot;</span>)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">TypeError</span>: creating indexed path attributes is not supported
</code></pre></div>
<p>值得注意的是，ObjectPath 不依赖于 <code>objectify</code> 模块或 <code>ObjectifiedElement</code> 实现。 它还可以与普通 <code>lxml.etree</code> API 中的元素结合使用。</p>
</div>
<div class="tabbed-block">
<p><strong>ObjectPath</strong></p>
<p>For both convenience and speed, objectify supports its own path language, represented by the ObjectPath class:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;{http://ns/}root&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>b1 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://ns/}b&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>c  <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(b1,   <span style="color: #BA2121">&quot;{http://ns/}c&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>b2 <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://ns/}b&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>d  <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>SubElement(root, <span style="color: #BA2121">&quot;{http://other/}d&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.b.c&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(path)
<span style="color: #717171">root.b.c</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>hasattr(root)
<span style="color: #717171">True</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(path<span style="color: #666666">.</span>find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}c</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.b.c&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}c</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.{http://other/}d&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://other/}d</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.</span><span style="color: #A45A77; font-weight: bold">{not}</span><span style="color: #BA2121">there&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: {not}there

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">{not}</span><span style="color: #BA2121">there&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">ValueError</span>: root element does not match: need {not}there, got {http://ns/}root

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.b[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;root.{http://ns/}b[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>
</code></pre></div>
<p>Apart from strings, ObjectPath also accepts lists of path segments:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath([<span style="color: #BA2121">&#39;root&#39;</span>, <span style="color: #BA2121">&#39;b&#39;</span>, <span style="color: #BA2121">&#39;c&#39;</span>])
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}c</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath([<span style="color: #BA2121">&#39;root&#39;</span>, <span style="color: #BA2121">&#39;{http://ns/}b[1]&#39;</span>])
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>
</code></pre></div>
<p>You can also use relative paths starting with a '.' to ignore the actual root element and only inherit its namespace:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.b[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath([<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #BA2121">&#39;b[1]&#39;</span>])
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}b</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.unknown[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: {http://ns/}unknown

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.{http://other/}unknown[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: {http://other/}unknown
</code></pre></div>
<p>For convenience, a single dot represents the empty ObjectPath (identity):</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>find <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(find(root)<span style="color: #666666">.</span>tag)
<span style="color: #717171">{http://ns/}root</span>
</code></pre></div>
<p>ObjectPath objects can be used to manipulate trees:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;{http://ns/}root&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.some.child.{http://other/}unknown&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>hasattr(root)
<span style="color: #717171">False</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>find(root)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: {http://ns/}some

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>setattr(root, <span style="color: #BA2121">&quot;my value&quot;</span>) <span style="color: #3D7B7B; font-style: italic"># creates children as necessary</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>hasattr(root)
<span style="color: #717171">True</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(path<span style="color: #666666">.</span>find(root)<span style="color: #666666">.</span>text)
<span style="color: #717171">my value</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>some<span style="color: #666666">.</span>child[<span style="color: #BA2121">&quot;{http://other/}unknown&quot;</span>]<span style="color: #666666">.</span>text)
<span style="color: #717171">my value</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">len</span>( path<span style="color: #666666">.</span>find(root) ))
<span style="color: #717171">1</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>addattr(root, <span style="color: #BA2121">&quot;my new value&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">len</span>( path<span style="color: #666666">.</span>find(root) ))
<span style="color: #717171">2</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>text <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> path<span style="color: #666666">.</span>find(root) ]
<span style="color: #717171">[&#39;my value&#39;, &#39;my new value&#39;]</span>
</code></pre></div>
<p>As with attribute assignment, setattr() accepts lists:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>setattr(root, [<span style="color: #BA2121">&quot;v1&quot;</span>, <span style="color: #BA2121">&quot;v2&quot;</span>, <span style="color: #BA2121">&quot;v3&quot;</span>])
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ el<span style="color: #666666">.</span>text <span style="color: #008000; font-weight: bold">for</span> el <span style="color: #AA22FF; font-weight: bold">in</span> path<span style="color: #666666">.</span>find(root) ]
<span style="color: #717171">[&#39;v1&#39;, &#39;v2&#39;, &#39;v3&#39;]</span>
</code></pre></div>
<p>Note, however, that indexing is only supported in this context if the children exist. Indexing of non existing children will not extend or create a list of such children but raise an exception:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectPath(<span style="color: #BA2121">&quot;.</span><span style="color: #A45A77; font-weight: bold">{non}</span><span style="color: #BA2121">existing[1]&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>path<span style="color: #666666">.</span>setattr(root, <span style="color: #BA2121">&quot;my value&quot;</span>)
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">TypeError</span>: creating indexed path attributes is not supported
</code></pre></div>
<p>It is worth noting that ObjectPath does not depend on the objectify module or the ObjectifiedElement implementation. It can also be used in combination with Elements from the normal lxml.etree API.</p>
</div>
</div>
</div>
<h2 id="python数据类型">Python数据类型<a class="headerlink" href="#python数据类型" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">中文</label><label for="__tabbed_9_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>objectify 模块了解 Python 数据类型，并尽力让元素内容表现得像它们。 例如，它们支持普通的数学运算符：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(
<span style="color: #000080; font-weight: bold">... </span>            <span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;5&lt;/a&gt;&lt;b&gt;11&lt;/b&gt;&lt;c&gt;true&lt;/c&gt;&lt;d&gt;hoi&lt;/d&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">+</span> root<span style="color: #666666">.</span>b
<span style="color: #717171">16</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">+=</span> root<span style="color: #666666">.</span>b
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a)
<span style="color: #717171">16</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> <span style="color: #666666">2</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a <span style="color: #666666">+</span> <span style="color: #666666">2</span>)
<span style="color: #717171">4</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #666666">1</span> <span style="color: #666666">+</span> root<span style="color: #666666">.</span>a)
<span style="color: #717171">3</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>c)
<span style="color: #717171">True</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>c <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> root<span style="color: #666666">.</span>c:
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;false!&quot;</span>)
<span style="color: #717171">false!</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>d <span style="color: #666666">+</span> <span style="color: #BA2121">&quot; test !&quot;</span>)
<span style="color: #717171">hoi test !</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>d <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121"> - </span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121">&quot;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>d <span style="color: #666666">%</span> (<span style="color: #666666">1234</span>, <span style="color: #666666">12345</span>))
<span style="color: #717171">1234 - 12345</span>
</code></pre></div>
<p>但是，数据元素继续提供 <strong>objectify API</strong>。 这意味着诸如 <code>len()</code>、切片和索引（例如字符串）之类的序列操作不能表现为 Python 类型。 与所有其他树元素一样，它们显示了 <strong>objectify</strong> 元素的正常切片行为：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;test&lt;/a&gt;&lt;b&gt;toast&lt;/b&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a <span style="color: #666666">+</span> <span style="color: #BA2121">&#39; me&#39;</span>) <span style="color: #3D7B7B; font-style: italic"># behaves like a string, right?</span>
<span style="color: #717171">test me</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">len</span>(root<span style="color: #666666">.</span>a) <span style="color: #3D7B7B; font-style: italic"># but there&#39;s only one &#39;a&#39; element!</span>
<span style="color: #717171">1</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ a<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> a <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>a ]
<span style="color: #717171">[&#39;a&#39;]</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">a</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a)
<span style="color: #717171">test</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ <span style="color: #008000">str</span>(a) <span style="color: #008000; font-weight: bold">for</span> a <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>a[:<span style="color: #666666">1</span>] ]
<span style="color: #717171">[&#39;test&#39;]</span>
</code></pre></div>
<p>如果需要对数据类型运行序列操作，则必须向 API 询问真实的 Python 值。 字符串值始终可以通过普通的 <code>ElementTree</code> 的 <code>.text</code> 属性获得。 此外，所有数据类都提供 <code>.pyval</code> 属性，该属性以纯 Python 类型返回值：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;test&lt;/a&gt;&lt;b&gt;5&lt;/b&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>text
<span style="color: #717171">&#39;test&#39;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>pyval
<span style="color: #717171">&#39;test&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>text
<span style="color: #717171">&#39;5&#39;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>pyval
<span style="color: #717171">5</span>
</code></pre></div>
<p>但请注意，这两个属性在 <strong>objectify</strong> 中都是只读的。 如果要更改值，只需将它们直接分配给属性即可：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>text  <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;25&quot;</span>
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">TypeError</span>: attribute &#39;text&#39; of &#39;StringElement&#39; objects is not writable

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>pyval <span style="color: #666666">=</span> <span style="color: #666666">25</span>
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">TypeError</span>: attribute &#39;pyval&#39; of &#39;StringElement&#39; objects is not writable

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> <span style="color: #666666">25</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a)
<span style="color: #717171">25</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>pyval)
<span style="color: #717171">25</span>
</code></pre></div>
<p>换句话说，<strong>objectify</strong> 数据元素的行为就像不可变的 Python 类型。 您可以替换它们，但不能修改它们。</p>
</div>
<div class="tabbed-block">
<p><strong>Python data types</strong></p>
<p>The objectify module knows about Python data types and tries its best to let element content behave like them. For example, they support the normal math operators:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(
<span style="color: #000080; font-weight: bold">... </span>            <span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;5&lt;/a&gt;&lt;b&gt;11&lt;/b&gt;&lt;c&gt;true&lt;/c&gt;&lt;d&gt;hoi&lt;/d&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">+</span> root<span style="color: #666666">.</span>b
<span style="color: #717171">16</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">+=</span> root<span style="color: #666666">.</span>b
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a)
<span style="color: #717171">16</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> <span style="color: #666666">2</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a <span style="color: #666666">+</span> <span style="color: #666666">2</span>)
<span style="color: #717171">4</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #666666">1</span> <span style="color: #666666">+</span> root<span style="color: #666666">.</span>a)
<span style="color: #717171">3</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>c)
<span style="color: #717171">True</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>c <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">False</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> root<span style="color: #666666">.</span>c:
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;false!&quot;</span>)
<span style="color: #717171">false!</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>d <span style="color: #666666">+</span> <span style="color: #BA2121">&quot; test !&quot;</span>)
<span style="color: #717171">hoi test !</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>d <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121"> - </span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121">&quot;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>d <span style="color: #666666">%</span> (<span style="color: #666666">1234</span>, <span style="color: #666666">12345</span>))
<span style="color: #717171">1234 - 12345</span>
</code></pre></div>
<p>However, data elements continue to provide the objectify API. This means that sequence operations such as len(), slicing and indexing (e.g. of strings) cannot behave as the Python types. Like all other tree elements, they show the normal slicing behaviour of objectify elements:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;test&lt;/a&gt;&lt;b&gt;toast&lt;/b&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a <span style="color: #666666">+</span> <span style="color: #BA2121">&#39; me&#39;</span>) <span style="color: #3D7B7B; font-style: italic"># behaves like a string, right?</span>
<span style="color: #717171">test me</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">len</span>(root<span style="color: #666666">.</span>a) <span style="color: #3D7B7B; font-style: italic"># but there&#39;s only one &#39;a&#39; element!</span>
<span style="color: #717171">1</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ a<span style="color: #666666">.</span>tag <span style="color: #008000; font-weight: bold">for</span> a <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>a ]
<span style="color: #717171">[&#39;a&#39;]</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>tag)
<span style="color: #717171">a</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a)
<span style="color: #717171">test</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>[ <span style="color: #008000">str</span>(a) <span style="color: #008000; font-weight: bold">for</span> a <span style="color: #AA22FF; font-weight: bold">in</span> root<span style="color: #666666">.</span>a[:<span style="color: #666666">1</span>] ]
<span style="color: #717171">[&#39;test&#39;]</span>
</code></pre></div>
<p>If you need to run sequence operations on data types, you must ask the API for the real Python value. The string value is always available through the normal ElementTree .text attribute. Additionally, all data classes provide a .pyval attribute that returns the value as plain Python type:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;test&lt;/a&gt;&lt;b&gt;5&lt;/b&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>text
<span style="color: #717171">&#39;test&#39;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>pyval
<span style="color: #717171">&#39;test&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>text
<span style="color: #717171">&#39;5&#39;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>pyval
<span style="color: #717171">5</span>
</code></pre></div>
<p>Note, however, that both attributes are read-only in objectify. If you want to change values, just assign them directly to the attribute:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>text  <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;25&quot;</span>
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">TypeError</span>: attribute &#39;text&#39; of &#39;StringElement&#39; objects is not writable

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>pyval <span style="color: #666666">=</span> <span style="color: #666666">25</span>
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">TypeError</span>: attribute &#39;pyval&#39; of &#39;StringElement&#39; objects is not writable

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> <span style="color: #666666">25</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a)
<span style="color: #717171">25</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>pyval)
<span style="color: #717171">25</span>
</code></pre></div>
<p>In other words, objectify data elements behave like immutable Python types. You can replace them, but not modify them.</p>
</div>
</div>
</div>
<h3 id="递归数并表示">递归数并表示<a class="headerlink" href="#递归数并表示" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">中文</label><label for="__tabbed_10_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>要查看当前使用的数据类型，您可以调用模块级 <code>dump()</code> 函数，该函数返回元素的递归字符串表示形式：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&quot;&quot;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;a attr1=&quot;foo&quot; attr2=&quot;bar&quot;&gt;1&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;a&gt;1.2&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;b&gt;1&lt;/b&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;b&gt;true&lt;/b&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;c&gt;what?&lt;/c&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;d xsi:nil=&quot;true&quot;/&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&quot;&quot;&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = 1 [IntElement]</span>
<span style="color: #717171">      * attr1 = &#39;foo&#39;</span>
<span style="color: #717171">      * attr2 = &#39;bar&#39;</span>
<span style="color: #717171">    a = 1.2 [FloatElement]</span>
<span style="color: #717171">    b = 1 [IntElement]</span>
<span style="color: #717171">    b = True [BoolElement]</span>
<span style="color: #717171">    c = &#39;what?&#39; [StringElement]</span>
<span style="color: #717171">    d = None [NoneElement]</span>
<span style="color: #717171">      * xsi:nil = &#39;true&#39;</span>
</code></pre></div>
<p>您可以在同一个子节点的不同类型之间自由切换：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;5&lt;/a&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = 5 [IntElement]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;nice string!&#39;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = &#39;nice string!&#39; [StringElement]</span>
<span style="color: #717171">      * py:pytype = &#39;str&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = True [BoolElement]</span>
<span style="color: #717171">      * py:pytype = &#39;bool&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> [<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = 1 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">    a = 2 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">    a = 3 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> (<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = 1 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">    a = 2 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">    a = 3 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Recursive tree dump</strong></p>
<p>To see the data types that are currently used, you can call the module level dump() function that returns a recursive string representation for elements:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&quot;&quot;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;a attr1=&quot;foo&quot; attr2=&quot;bar&quot;&gt;1&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;a&gt;1.2&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;b&gt;1&lt;/b&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;b&gt;true&lt;/b&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;c&gt;what?&lt;/c&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;d xsi:nil=&quot;true&quot;/&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&quot;&quot;&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = 1 [IntElement]</span>
<span style="color: #717171">      * attr1 = &#39;foo&#39;</span>
<span style="color: #717171">      * attr2 = &#39;bar&#39;</span>
<span style="color: #717171">    a = 1.2 [FloatElement]</span>
<span style="color: #717171">    b = 1 [IntElement]</span>
<span style="color: #717171">    b = True [BoolElement]</span>
<span style="color: #717171">    c = &#39;what?&#39; [StringElement]</span>
<span style="color: #717171">    d = None [NoneElement]</span>
<span style="color: #717171">      * xsi:nil = &#39;true&#39;</span>
</code></pre></div>
<p>You can freely switch between different types for the same child:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;5&lt;/a&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = 5 [IntElement]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;nice string!&#39;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = &#39;nice string!&#39; [StringElement]</span>
<span style="color: #717171">      * py:pytype = &#39;str&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">True</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = True [BoolElement]</span>
<span style="color: #717171">      * py:pytype = &#39;bool&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> [<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>]
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = 1 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">    a = 2 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">    a = 3 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a <span style="color: #666666">=</span> (<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">3</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = 1 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">    a = 2 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">    a = 3 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="元素的递归字符串表示">元素的递归字符串表示<a class="headerlink" href="#元素的递归字符串表示" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">中文</label><label for="__tabbed_11_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>通常，元素使用 <strong>lxml.etree</strong> 提供的 <code>str()</code> 标准字符串表示形式。 您可以为对象化元素启用漂亮的打印表示，如下所示：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>enable_recursive_str()

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&quot;&quot;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;a attr1=&quot;foo&quot; attr2=&quot;bar&quot;&gt;1&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;a&gt;1.2&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;b&gt;1&lt;/b&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;b&gt;true&lt;/b&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;c&gt;what?&lt;/c&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;d xsi:nil=&quot;true&quot;/&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&quot;&quot;&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">str</span>(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = 1 [IntElement]</span>
<span style="color: #717171">      * attr1 = &#39;foo&#39;</span>
<span style="color: #717171">      * attr2 = &#39;bar&#39;</span>
<span style="color: #717171">    a = 1.2 [FloatElement]</span>
<span style="color: #717171">    b = 1 [IntElement]</span>
<span style="color: #717171">    b = True [BoolElement]</span>
<span style="color: #717171">    c = &#39;what?&#39; [StringElement]</span>
<span style="color: #717171">    d = None [NoneElement]</span>
<span style="color: #717171">      * xsi:nil = &#39;true&#39;</span>
</code></pre></div>
<p>可以用相同的方式关闭此行为：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>enable_recursive_str(<span style="color: #008000; font-weight: bold">False</span>)
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Recursive string representation of elements</strong></p>
<p>Normally, elements use the standard string representation for str() that is provided by lxml.etree. You can enable a pretty-print representation for objectify elements like this:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>enable_recursive_str()

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&quot;&quot;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;a attr1=&quot;foo&quot; attr2=&quot;bar&quot;&gt;1&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;a&gt;1.2&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;b&gt;1&lt;/b&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;b&gt;true&lt;/b&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;c&gt;what?&lt;/c&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;d xsi:nil=&quot;true&quot;/&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&quot;&quot;&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(<span style="color: #008000">str</span>(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = 1 [IntElement]</span>
<span style="color: #717171">      * attr1 = &#39;foo&#39;</span>
<span style="color: #717171">      * attr2 = &#39;bar&#39;</span>
<span style="color: #717171">    a = 1.2 [FloatElement]</span>
<span style="color: #717171">    b = 1 [IntElement]</span>
<span style="color: #717171">    b = True [BoolElement]</span>
<span style="color: #717171">    c = &#39;what?&#39; [StringElement]</span>
<span style="color: #717171">    d = None [NoneElement]</span>
<span style="color: #717171">      * xsi:nil = &#39;true&#39;</span>
</code></pre></div>
<p>This behaviour can be switched off in the same way:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>enable_recursive_str(<span style="color: #008000; font-weight: bold">False</span>)
</code></pre></div>
</div>
</div>
</div>
<h2 id="如何匹配数据类型">如何匹配数据类型<a class="headerlink" href="#如何匹配数据类型" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">中文</label><label for="__tabbed_12_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Objectify 使用两种不同类型的元素。 结构元素（或树元素）表示对象树结构。 数据元素表示叶节点处的数据容器。 您可以使用<a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.Element">objectify.Element()</a>工厂显式创建树元素，并使用 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.DataElement">objectify.DataElement()</a> 工厂显式创建数据元素。</p>
<p>创建 Element 对象时，<strong>lxml.objectify</strong> 必须确定要为它们使用哪个实现类。 这对于树元素来说相对容易，而对于数据元素则不太容易。 算法如下：</p>
<ol>
<li>如果元素有子元素，则使用默认的树类。</li>
<li>如果元素定义为 <code>xsi:nil</code>，请使用 <strong><a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.NoneElement">NoneElement</a></strong> 类。</li>
<li>如果给出了“Python 类型注解”属性，请使用它来确定元素类，请参见下文。</li>
<li>如果给出了 XML Schema xsi:type 提示，请使用它来确定元素类，请参见下文。</li>
<li>尝试通过反复试验从文本内容类型确定元素类。</li>
<li>如果元素是根节点，则使用默认树类。</li>
<li>否则，对空数据类使用默认类。</li>
</ol>
<p>您可以在设置时更改树元素和空数据元素的默认类。 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.ObjectifyElementClassLookup">ObjectifyElementClassLookup()</a> 调用接受两个关键字参数 <code>tree_class</code> 和 <code>empty_data_class</code>，它们确定在这些情况下使用的 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.Element">Element</a> 类。 默认情况下，<code>tree_class</code> 是一个名为<a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.ObjectifiedElement">ObjectifiedElement</a> 的类，<code>empty_data_class</code> 是一个 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.StringElement">StringElement</a> 。</p>
</div>
<div class="tabbed-block">
<p><strong>How data types are matched</strong></p>
<p>Objectify uses two different types of Elements. Structural Elements (or tree Elements) represent the object tree structure. Data Elements represent the data containers at the leafs. You can explicitly create tree Elements with the <code>objectify.Element()</code> factory and data Elements with the <code>objectify.DataElement()</code> factory.</p>
<p>When Element objects are created, lxml.objectify must determine which implementation class to use for them. This is relatively easy for tree Elements and less so for data Elements. The algorithm is as follows:</p>
<ol>
<li>If an element has children, use the default tree class.</li>
<li>If an element is defined as xsi:nil, use the NoneElement class.</li>
<li>If a "Python type hint" attribute is given, use this to determine the element class, see below.</li>
<li>If an XML Schema xsi:type hint is given, use this to determine the element class, see below.</li>
<li>Try to determine the element class from the text content type by trial and error.</li>
<li>If the element is a root node then use the default tree class.</li>
<li>Otherwise, use the default class for empty data classes.</li>
</ol>
<p>You can change the default classes for tree Elements and empty data Elements at setup time. The <code>ObjectifyElementClassLookup()</code> call accepts two keyword arguments, <code>tree_class</code> and <code>empty_data_class</code>, that determine the Element classes used in these cases. By default, tree_class is a class called <code>ObjectifiedElement</code> and <code>empty_data_class</code> is a StringElement.</p>
</div>
</div>
</div>
<h3 id="类型注解">类型注解<a class="headerlink" href="#类型注解" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">中文</label><label for="__tabbed_13_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>"类型注解" 机制部署定义为 <code>lxml.objectify.PYTYPE_ATTRIBUTE</code> 的 XML 属性。 它可能包含以下任何字符串值：<code>int</code>、<code>long</code>、<code>float</code>、<code>str</code>、<code>unicode</code>、<code>NoneType</code>：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>PYTYPE_ATTRIBUTE)
<span style="color: #717171">{http://codespeak.net/lxml/objectify/pytype}pytype</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>ns, name <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>PYTYPE_ATTRIBUTE[<span style="color: #666666">1</span>:]<span style="color: #666666">.</span>split(<span style="color: #BA2121">&#39;}&#39;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&quot;&quot;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;root xmlns:py=&#39;</span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121">&#39;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;a py:pytype=&#39;str&#39;&gt;5&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;b py:pytype=&#39;int&#39;&gt;5&lt;/b&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;c py:pytype=&#39;NoneType&#39; /&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&quot;&quot;&quot;</span> <span style="color: #666666">%</span> ns)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a <span style="color: #666666">+</span> <span style="color: #666666">10</span>)
<span style="color: #717171">510</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b <span style="color: #666666">+</span> <span style="color: #666666">10</span>)
<span style="color: #717171">15</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>c)
<span style="color: #717171">None</span>
</code></pre></div>
<p>请注意，您可以通过 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.set_pytype_attribute_tag">set_pytype_attribute_tag(tag)</a> 模块函数更改用于此属性的名称和命名空间，以防您的应用程序需要。 还有一个实用函数 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.annotate">annotate()</a> 可以为树的元素递归生成此属性：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;test&lt;/a&gt;&lt;b&gt;5&lt;/b&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = &#39;test&#39; [StringElement]</span>
<span style="color: #717171">    b = 5 [IntElement]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>annotate(root)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = &#39;test&#39; [StringElement]</span>
<span style="color: #717171">      * py:pytype = &#39;str&#39;</span>
<span style="color: #717171">    b = 5 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Type annotations</strong></p>
<p>The "type hint" mechanism deploys an XML attribute defined as <code>lxml.objectify.PYTYPE_ATTRIBUTE</code>. It may contain any of the following string values: int, long, float, str, unicode, NoneType:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>PYTYPE_ATTRIBUTE)
<span style="color: #717171">{http://codespeak.net/lxml/objectify/pytype}pytype</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>ns, name <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>PYTYPE_ATTRIBUTE[<span style="color: #666666">1</span>:]<span style="color: #666666">.</span>split(<span style="color: #BA2121">&#39;}&#39;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&quot;&quot;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;root xmlns:py=&#39;</span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121">&#39;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;a py:pytype=&#39;str&#39;&gt;5&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;b py:pytype=&#39;int&#39;&gt;5&lt;/b&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;c py:pytype=&#39;NoneType&#39; /&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&quot;&quot;&quot;</span> <span style="color: #666666">%</span> ns)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a <span style="color: #666666">+</span> <span style="color: #666666">10</span>)
<span style="color: #717171">510</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>b <span style="color: #666666">+</span> <span style="color: #666666">10</span>)
<span style="color: #717171">15</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>c)
<span style="color: #717171">None</span>
</code></pre></div>
<p>Note that you can change the name and namespace used for this attribute through the set_pytype_attribute_tag(tag) module function, in case your application ever needs to. There is also a utility function annotate() that recursively generates this attribute for the elements of a tree:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;test&lt;/a&gt;&lt;b&gt;5&lt;/b&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = &#39;test&#39; [StringElement]</span>
<span style="color: #717171">    b = 5 [IntElement]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>annotate(root)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = &#39;test&#39; [StringElement]</span>
<span style="color: #717171">      * py:pytype = &#39;str&#39;</span>
<span style="color: #717171">    b = 5 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="xml-schema的数据类型注释">XML Schema的数据类型注释<a class="headerlink" href="#xml-schema的数据类型注释" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">中文</label><label for="__tabbed_14_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>指定数据类型信息的第二种方法使用 XML Schema类型作为元素注解。 <strong>Objectify</strong> 知道那些可以映射到普通 Python 类型的类型：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">         xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">     &lt;d xsi:type=&quot;xsd:double&quot;&gt;5&lt;/d&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">     &lt;i xsi:type=&quot;xsd:int&quot;   &gt;5&lt;/i&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">     &lt;s xsi:type=&quot;xsd:string&quot;&gt;5&lt;/s&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    d = 5.0 [FloatElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:double&#39;</span>
<span style="color: #717171">    i = 5 [IntElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:int&#39;</span>
<span style="color: #717171">    s = &#39;5&#39; [StringElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:string&#39;</span>
</code></pre></div>
<p>同样，有一个实用函数 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.xsiannotate">xsiannotate()</a> 可以递归地为树的元素生成<strong>“xsi:type”</strong> 属性：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &lt;root&gt;&lt;a&gt;test&lt;/a&gt;&lt;b&gt;5&lt;/b&gt;&lt;c&gt;true&lt;/c&gt;&lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = &#39;test&#39; [StringElement]</span>
<span style="color: #717171">    b = 5 [IntElement]</span>
<span style="color: #717171">    c = True [BoolElement]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>xsiannotate(root)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = &#39;test&#39; [StringElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:string&#39;</span>
<span style="color: #717171">    b = 5 [IntElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:integer&#39;</span>
<span style="color: #717171">    c = True [BoolElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:boolean&#39;</span>
</code></pre></div>
<p>但请注意，<a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.xsiannotate">xsiannotate()</a> 将始终使用为任何给定 Python 类型定义的第一个 XML 架构数据类型，另请参阅<a href="#定义附加数据类"><strong>定义附加数据类</strong></a>(Defining additional data classes)。</p>
<p>实用函数 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.deannotate" target="_balnk">deannotate()</a> 可用于删除 <mark class="critic"> py:pytype </mark> 和/或 <mark class="critic"> xsi:type </mark> 信息：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">      xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;d xsi:type=&quot;xsd:double&quot;&gt;5&lt;/d&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;i xsi:type=&quot;xsd:int&quot;   &gt;5&lt;/i&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;s xsi:type=&quot;xsd:string&quot;&gt;5&lt;/s&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;/root&gt;&#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>annotate(root)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    d = 5.0 [FloatElement]</span>
<span style="color: #717171">      * py:pytype = &#39;float&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:double&#39;</span>
<span style="color: #717171">    i = 5 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:int&#39;</span>
<span style="color: #717171">    s = &#39;5&#39; [StringElement]</span>
<span style="color: #717171">      * py:pytype = &#39;str&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:string&#39;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>deannotate(root)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    d = 5 [IntElement]</span>
<span style="color: #717171">    i = 5 [IntElement]</span>
<span style="color: #717171">    s = 5 [IntElement]</span>
</code></pre></div>
<p>您可以使用关键字参数 <code>pytype</code>（默认值：<code>True</code>）和 <code>xsi</code>（默认值：<code>True</code>）来控制应取消注释哪些类型属性。 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.deannotate" target="_balnk">deannotate()</a> 还可以通过设置 <code>xsi_nil=True</code> （默认值：<code>False</code>）来删除 <code>xsi:nil</code> 属性：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">      xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;d xsi:type=&quot;xsd:double&quot;&gt;5&lt;/d&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;i xsi:type=&quot;xsd:int&quot;   &gt;5&lt;/i&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;s xsi:type=&quot;xsd:string&quot;&gt;5&lt;/s&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;n xsi:nil=&quot;true&quot;/&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;/root&gt;&#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>annotate(root)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    d = 5.0 [FloatElement]</span>
<span style="color: #717171">      * py:pytype = &#39;float&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:double&#39;</span>
<span style="color: #717171">    i = 5 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:int&#39;</span>
<span style="color: #717171">    s = &#39;5&#39; [StringElement]</span>
<span style="color: #717171">      * py:pytype = &#39;str&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:string&#39;</span>
<span style="color: #717171">    n = None [NoneElement]</span>
<span style="color: #717171">      * py:pytype = &#39;NoneType&#39;</span>
<span style="color: #717171">      * xsi:nil = &#39;true&#39;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>deannotate(root, xsi_nil<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    d = 5 [IntElement]</span>
<span style="color: #717171">    i = 5 [IntElement]</span>
<span style="color: #717171">    s = 5 [IntElement]</span>
<span style="color: #717171">    n = u&#39;&#39; [StringElement]</span>
</code></pre></div>
<p>请注意，默认情况下 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.deannotate" target="_balnk">deannotate()</a> 不会删除 <code>pytype</code> 命名空间的命名空间声明。 要删除它们，并通常清理文档中的命名空间声明（通常在完成整个处理时），请传递选项 <code>cleanup_namespaces=True</code>。 此选项是 <code>lxml 2.3.2</code> 中的新增选项。 在旧版本中，请改用函数 <a href="https://lxml.de/apidoc/lxml.etree.html#lxml.etree.cleanup_namespaces" target="_blank">lxml.etree.cleanup_namespaces()</a>。</p>
</div>
<div class="tabbed-block">
<p><strong>XML Schema datatype annotation</strong></p>
<p>A second way of specifying data type information uses XML Schema types as element annotations. Objectify knows those that can be mapped to normal Python types:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">         xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">     &lt;d xsi:type=&quot;xsd:double&quot;&gt;5&lt;/d&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">     &lt;i xsi:type=&quot;xsd:int&quot;   &gt;5&lt;/i&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">     &lt;s xsi:type=&quot;xsd:string&quot;&gt;5&lt;/s&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    d = 5.0 [FloatElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:double&#39;</span>
<span style="color: #717171">    i = 5 [IntElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:int&#39;</span>
<span style="color: #717171">    s = &#39;5&#39; [StringElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:string&#39;</span>
</code></pre></div>
<p>Again, there is a utility function xsiannotate() that recursively generates the "xsi:type" attribute for the elements of a tree:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &lt;root&gt;&lt;a&gt;test&lt;/a&gt;&lt;b&gt;5&lt;/b&gt;&lt;c&gt;true&lt;/c&gt;&lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = &#39;test&#39; [StringElement]</span>
<span style="color: #717171">    b = 5 [IntElement]</span>
<span style="color: #717171">    c = True [BoolElement]</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>xsiannotate(root)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    a = &#39;test&#39; [StringElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:string&#39;</span>
<span style="color: #717171">    b = 5 [IntElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:integer&#39;</span>
<span style="color: #717171">    c = True [BoolElement]</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:boolean&#39;</span>
</code></pre></div>
<p>Note, however, that xsiannotate() will always use the first XML Schema datatype that is defined for any given Python type, see also <strong>Defining additional data classes</strong>.</p>
<p>The utility function deannotate() can be used to get rid of 'py:pytype' and/or 'xsi:type' information:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">      xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;d xsi:type=&quot;xsd:double&quot;&gt;5&lt;/d&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;i xsi:type=&quot;xsd:int&quot;   &gt;5&lt;/i&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;s xsi:type=&quot;xsd:string&quot;&gt;5&lt;/s&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;/root&gt;&#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>annotate(root)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    d = 5.0 [FloatElement]</span>
<span style="color: #717171">      * py:pytype = &#39;float&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:double&#39;</span>
<span style="color: #717171">    i = 5 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:int&#39;</span>
<span style="color: #717171">    s = &#39;5&#39; [StringElement]</span>
<span style="color: #717171">      * py:pytype = &#39;str&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:string&#39;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>deannotate(root)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    d = 5 [IntElement]</span>
<span style="color: #717171">    i = 5 [IntElement]</span>
<span style="color: #717171">    s = 5 [IntElement]</span>
</code></pre></div>
<p>You can control which type attributes should be de-annotated with the keyword arguments 'pytype' (default: True) and 'xsi' (default: True). deannotate() can also remove 'xsi:nil' attributes by setting 'xsi_nil=True' (default: False):</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">      xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;d xsi:type=&quot;xsd:double&quot;&gt;5&lt;/d&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;i xsi:type=&quot;xsd:int&quot;   &gt;5&lt;/i&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;s xsi:type=&quot;xsd:string&quot;&gt;5&lt;/s&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">  &lt;n xsi:nil=&quot;true&quot;/&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">&lt;/root&gt;&#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>annotate(root)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    d = 5.0 [FloatElement]</span>
<span style="color: #717171">      * py:pytype = &#39;float&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:double&#39;</span>
<span style="color: #717171">    i = 5 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:int&#39;</span>
<span style="color: #717171">    s = &#39;5&#39; [StringElement]</span>
<span style="color: #717171">      * py:pytype = &#39;str&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:string&#39;</span>
<span style="color: #717171">    n = None [NoneElement]</span>
<span style="color: #717171">      * py:pytype = &#39;NoneType&#39;</span>
<span style="color: #717171">      * xsi:nil = &#39;true&#39;</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>deannotate(root, xsi_nil<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    d = 5 [IntElement]</span>
<span style="color: #717171">    i = 5 [IntElement]</span>
<span style="color: #717171">    s = 5 [IntElement]</span>
<span style="color: #717171">    n = u&#39;&#39; [StringElement]</span>
</code></pre></div>
<p>Note that deannotate() does not remove the namespace declarations of the pytype namespace by default. To remove them as well, and to generally clean up the namespace declarations in the document (usually when done with the whole processing), pass the option <code>cleanup_namespaces=True</code>. This option is new in lxml 2.3.2. In older versions, use the function <code>lxml.etree.cleanup_namespaces()</code> instead.</p>
</div>
</div>
</div>
<h3 id="dataelement-工厂">DataElement 工厂<a class="headerlink" href="#dataelement-工厂" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><input id="__tabbed_15_2" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">中文</label><label for="__tabbed_15_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>为了方便起见， <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.DataElement" target="_blank">DataElement()</a> 工厂一步创建一个具有 Python 值的元素。 您可以传递所需的 <strong>Python 类型名称</strong>或 <strong>XSI 类型名称</strong>：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;root&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>x <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #666666">5</span>, _pytype<span style="color: #666666">=</span><span style="color: #BA2121">&quot;int&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    x = 5 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>x <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #666666">5</span>, _pytype<span style="color: #666666">=</span><span style="color: #BA2121">&quot;str&quot;</span>, myattr<span style="color: #666666">=</span><span style="color: #BA2121">&quot;someval&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    x = &#39;5&#39; [StringElement]</span>
<span style="color: #717171">      * myattr = &#39;someval&#39;</span>
<span style="color: #717171">      * py:pytype = &#39;str&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>x <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #666666">5</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&quot;integer&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    x = 5 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:integer&#39;</span>
</code></pre></div>
<p><strong>XML Schema 类型</strong> 驻留在 XML 模式命名空间中，因此 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.DataElement" target="_blank">DataElement()</a> 尝试为您正确添加 <code>xsi:type</code> 属性值前缀：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;root&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>s <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #666666">5</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&quot;string&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>deannotate(root, xsi<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span>
<span style="color: #717171">  &lt;s xsi:type=&quot;xsd:string&quot;&gt;5&lt;/s&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
<p><a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.DataElement" target="_blank">DataElement()</a> 使用默认的 <code>nsmap</code> 来设置这些前缀：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #BA2121">&#39;5&#39;</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&#39;string&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces <span style="color: #666666">=</span> <span style="color: #008000">list</span>(el<span style="color: #666666">.</span>nsmap<span style="color: #666666">.</span>items())
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces<span style="color: #666666">.</span>sort()
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">for</span> prefix, namespace <span style="color: #AA22FF; font-weight: bold">in</span> namespaces:
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121"> - </span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> (prefix, namespace))
<span style="color: #717171">py - http://codespeak.net/lxml/objectify/pytype</span>
<span style="color: #717171">xsd - http://www.w3.org/2001/XMLSchema</span>
<span style="color: #717171">xsi - http://www.w3.org/2001/XMLSchema-instance</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(el<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;{http://www.w3.org/2001/XMLSchema-instance}type&quot;</span>))
<span style="color: #717171">xsd:string</span>
</code></pre></div>
<p>虽然您可以设置自定义命名空间前缀，但如果您选择这样做，则必须提供有效的命名空间信息：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #BA2121">&#39;5&#39;</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&#39;foo:string&#39;</span>,
<span style="color: #000080; font-weight: bold">... </span>         nsmap<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;foo&#39;</span>: <span style="color: #BA2121">&#39;http://www.w3.org/2001/XMLSchema&#39;</span>})
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces <span style="color: #666666">=</span> <span style="color: #008000">list</span>(el<span style="color: #666666">.</span>nsmap<span style="color: #666666">.</span>items())
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces<span style="color: #666666">.</span>sort()
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">for</span> prefix, namespace <span style="color: #AA22FF; font-weight: bold">in</span> namespaces:
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121"> - </span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> (prefix, namespace))
<span style="color: #717171">foo - http://www.w3.org/2001/XMLSchema</span>
<span style="color: #717171">py - http://codespeak.net/lxml/objectify/pytype</span>
<span style="color: #717171">xsi - http://www.w3.org/2001/XMLSchema-instance</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(el<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;{http://www.w3.org/2001/XMLSchema-instance}type&quot;</span>))
<span style="color: #717171">foo:string</span>
</code></pre></div>
<p>请注意 lxml 是如何为 XML Schema 实例命名空间选择默认前缀的。 我们可以重写它，如下例所示：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #BA2121">&#39;5&#39;</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&#39;foo:string&#39;</span>,
<span style="color: #000080; font-weight: bold">... </span>         nsmap<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;foo&#39;</span>: <span style="color: #BA2121">&#39;http://www.w3.org/2001/XMLSchema&#39;</span>,
<span style="color: #000080; font-weight: bold">... </span>                <span style="color: #BA2121">&#39;myxsi&#39;</span>: <span style="color: #BA2121">&#39;http://www.w3.org/2001/XMLSchema-instance&#39;</span>})
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces <span style="color: #666666">=</span> <span style="color: #008000">list</span>(el<span style="color: #666666">.</span>nsmap<span style="color: #666666">.</span>items())
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces<span style="color: #666666">.</span>sort()
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">for</span> prefix, namespace <span style="color: #AA22FF; font-weight: bold">in</span> namespaces:
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121"> - </span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> (prefix, namespace))
<span style="color: #717171">foo - http://www.w3.org/2001/XMLSchema</span>
<span style="color: #717171">myxsi - http://www.w3.org/2001/XMLSchema-instance</span>
<span style="color: #717171">py - http://codespeak.net/lxml/objectify/pytype</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(el<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;{http://www.w3.org/2001/XMLSchema-instance}type&quot;</span>))
<span style="color: #717171">foo:string</span>
</code></pre></div>
<p>如果同一命名空间使用了不同的命名空间前缀，则必须小心。 命名空间信息被合并以避免在向树添加新子元素时出现重复定义，但此机制不适用于属性值的前缀：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&quot;&quot;&lt;root xmlns:schema=&quot;http://www.w3.org/2001/XMLSchema&quot;/&gt;&quot;&quot;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:schema=&quot;http://www.w3.org/2001/XMLSchema&quot;/&gt;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>s <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #BA2121">&quot;17&quot;</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&quot;string&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(s, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;value xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; py:pytype=&quot;str&quot; xsi:type=&quot;xsd:string&quot;&gt;17&lt;/value&gt;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>s <span style="color: #666666">=</span> s
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:schema=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #717171">  &lt;s xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; py:pytype=&quot;str&quot; xsi:type=&quot;xsd:string&quot;&gt;17&lt;/s&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
<p>如果您选择偏离标准前缀，则您有责任修复属性值的前缀。 对 <code>xsi:type</code> 属性执行此操作的一种便捷方法是使用 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.xsiannotate" target="_blank">xsiannotate()</a> 工具：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>xsiannotate(root)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:schema=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #717171">  &lt;s xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; py:pytype=&quot;str&quot; xsi:type=&quot;schema:string&quot;&gt;17&lt;/s&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
<p>当然，在构建对象化树时，不鼓励对同一个命名空间使用不同的前缀。</p>
</div>
<div class="tabbed-block">
<p><strong>The DataElement factory</strong></p>
<p>For convenience, the DataElement() factory creates an Element with a Python value in one step. You can pass the required Python type name or the XSI type name:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;root&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>x <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #666666">5</span>, _pytype<span style="color: #666666">=</span><span style="color: #BA2121">&quot;int&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    x = 5 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>x <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #666666">5</span>, _pytype<span style="color: #666666">=</span><span style="color: #BA2121">&quot;str&quot;</span>, myattr<span style="color: #666666">=</span><span style="color: #BA2121">&quot;someval&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    x = &#39;5&#39; [StringElement]</span>
<span style="color: #717171">      * myattr = &#39;someval&#39;</span>
<span style="color: #717171">      * py:pytype = &#39;str&#39;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>x <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #666666">5</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&quot;integer&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(objectify<span style="color: #666666">.</span>dump(root))
<span style="color: #717171">root = None [ObjectifiedElement]</span>
<span style="color: #717171">    x = 5 [IntElement]</span>
<span style="color: #717171">      * py:pytype = &#39;int&#39;</span>
<span style="color: #717171">      * xsi:type = &#39;xsd:integer&#39;</span>
</code></pre></div>
<p>XML Schema types reside in the XML schema namespace thus DataElement() tries to correctly prefix the xsi:type attribute value for you:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>Element(<span style="color: #BA2121">&quot;root&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>s <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #666666">5</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&quot;string&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>deannotate(root, xsi<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span>
<span style="color: #717171">  &lt;s xsi:type=&quot;xsd:string&quot;&gt;5&lt;/s&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
<p><code>DataElement()</code> uses a default nsmap to set these prefixes:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #BA2121">&#39;5&#39;</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&#39;string&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces <span style="color: #666666">=</span> <span style="color: #008000">list</span>(el<span style="color: #666666">.</span>nsmap<span style="color: #666666">.</span>items())
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces<span style="color: #666666">.</span>sort()
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">for</span> prefix, namespace <span style="color: #AA22FF; font-weight: bold">in</span> namespaces:
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121"> - </span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> (prefix, namespace))
<span style="color: #717171">py - http://codespeak.net/lxml/objectify/pytype</span>
<span style="color: #717171">xsd - http://www.w3.org/2001/XMLSchema</span>
<span style="color: #717171">xsi - http://www.w3.org/2001/XMLSchema-instance</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(el<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;{http://www.w3.org/2001/XMLSchema-instance}type&quot;</span>))
<span style="color: #717171">xsd:string</span>
</code></pre></div>
<p>While you can set custom namespace prefixes, it is necessary to provide valid namespace information if you choose to do so:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #BA2121">&#39;5&#39;</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&#39;foo:string&#39;</span>,
<span style="color: #000080; font-weight: bold">... </span>         nsmap<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;foo&#39;</span>: <span style="color: #BA2121">&#39;http://www.w3.org/2001/XMLSchema&#39;</span>})
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces <span style="color: #666666">=</span> <span style="color: #008000">list</span>(el<span style="color: #666666">.</span>nsmap<span style="color: #666666">.</span>items())
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces<span style="color: #666666">.</span>sort()
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">for</span> prefix, namespace <span style="color: #AA22FF; font-weight: bold">in</span> namespaces:
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121"> - </span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> (prefix, namespace))
<span style="color: #717171">foo - http://www.w3.org/2001/XMLSchema</span>
<span style="color: #717171">py - http://codespeak.net/lxml/objectify/pytype</span>
<span style="color: #717171">xsi - http://www.w3.org/2001/XMLSchema-instance</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(el<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;{http://www.w3.org/2001/XMLSchema-instance}type&quot;</span>))
<span style="color: #717171">foo:string</span>
</code></pre></div>
<p>Note how lxml chose a default prefix for the XML Schema Instance namespace. We can override it as in the following example:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>el <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #BA2121">&#39;5&#39;</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&#39;foo:string&#39;</span>,
<span style="color: #000080; font-weight: bold">... </span>         nsmap<span style="color: #666666">=</span>{<span style="color: #BA2121">&#39;foo&#39;</span>: <span style="color: #BA2121">&#39;http://www.w3.org/2001/XMLSchema&#39;</span>,
<span style="color: #000080; font-weight: bold">... </span>                <span style="color: #BA2121">&#39;myxsi&#39;</span>: <span style="color: #BA2121">&#39;http://www.w3.org/2001/XMLSchema-instance&#39;</span>})
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces <span style="color: #666666">=</span> <span style="color: #008000">list</span>(el<span style="color: #666666">.</span>nsmap<span style="color: #666666">.</span>items())
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>namespaces<span style="color: #666666">.</span>sort()
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">for</span> prefix, namespace <span style="color: #AA22FF; font-weight: bold">in</span> namespaces:
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;</span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121"> - </span><span style="color: #A45A77; font-weight: bold">%s</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> (prefix, namespace))
<span style="color: #717171">foo - http://www.w3.org/2001/XMLSchema</span>
<span style="color: #717171">myxsi - http://www.w3.org/2001/XMLSchema-instance</span>
<span style="color: #717171">py - http://codespeak.net/lxml/objectify/pytype</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(el<span style="color: #666666">.</span>get(<span style="color: #BA2121">&quot;{http://www.w3.org/2001/XMLSchema-instance}type&quot;</span>))
<span style="color: #717171">foo:string</span>
</code></pre></div>
<p>Care must be taken if different namespace prefixes have been used for the same namespace. Namespace information gets merged to avoid duplicate definitions when adding a new sub-element to a tree, but this mechanism does not adapt the prefixes of attribute values:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&quot;&quot;&quot;&lt;root xmlns:schema=&quot;http://www.w3.org/2001/XMLSchema&quot;/&gt;&quot;&quot;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:schema=&quot;http://www.w3.org/2001/XMLSchema&quot;/&gt;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>s <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>DataElement(<span style="color: #BA2121">&quot;17&quot;</span>, _xsi<span style="color: #666666">=</span><span style="color: #BA2121">&quot;string&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(s, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;value xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; py:pytype=&quot;str&quot; xsi:type=&quot;xsd:string&quot;&gt;17&lt;/value&gt;</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>s <span style="color: #666666">=</span> s
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:schema=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #717171">  &lt;s xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; py:pytype=&quot;str&quot; xsi:type=&quot;xsd:string&quot;&gt;17&lt;/s&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
<p>It is your responsibility to fix the prefixes of attribute values if you choose to deviate from the standard prefixes. A convenient way to do this for xsi:type attributes is to use the xsiannotate() utility:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>objectify<span style="color: #666666">.</span>xsiannotate(root)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(etree<span style="color: #666666">.</span>tostring(root, pretty_print<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>))
<span style="color: #717171">&lt;root xmlns:schema=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;</span>
<span style="color: #717171">  &lt;s xmlns:py=&quot;http://codespeak.net/lxml/objectify/pytype&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; py:pytype=&quot;str&quot; xsi:type=&quot;schema:string&quot;&gt;17&lt;/s&gt;</span>
<span style="color: #717171">&lt;/root&gt;</span>
</code></pre></div>
<p>Of course, it is discouraged to use different prefixes for one and the same namespace when building up an objectify tree.</p>
</div>
</div>
</div>
<h3 id="定义附加数据类">定义附加数据类<a class="headerlink" href="#定义附加数据类" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><input id="__tabbed_16_2" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">中文</label><label for="__tabbed_16_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>您可以将其他数据类插入 objectify，其使用方式与预定义类型完全相同。 数据类可以直接从 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.ObjectifiedDataElement" target="_balnk">ObjectifiedDataElement</a> 继承，也可以从 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.NumberElement" target="_blank">NumberElement</a> 或 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.BoolElement" target="_blank">BoolElement</a> 等专用类之一继承。 数字类型需要初始调用 <code>NumberElement</code> 的 <code>self._setValueParser(function)</code> 方法来设置其类型转换函数（字符串 -&gt;  Python 数字类型）。 此调用应放入 <code>element _init()</code> 方法中。</p>
<p>数据类的注册使用 <a href="https://lxml.de/apidoc/lxml.objectify.html#lxml.objectify.PyType" target="_blank">PyType</a> 类：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ChristmasDate</span>(objectify<span style="color: #666666">.</span>ObjectifiedDataElement):
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">call_santa</span>(<span style="color: #008000">self</span>):
<span style="color: #000080; font-weight: bold">... </span>        <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Ho ho ho!&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">checkChristmasDate</span>(date_string):
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> date_string<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">&#39;24.12.&#39;</span>):
<span style="color: #000080; font-weight: bold">... </span>        <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span> <span style="color: #3D7B7B; font-style: italic"># or TypeError</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xmas_type <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>PyType(<span style="color: #BA2121">&#39;date&#39;</span>, checkChristmasDate, ChristmasDate)
</code></pre></div>
<p><code>PyType</code> 构造函数接受字符串类型名称、(可选的)可调用类型检查和自定义数据类。如果提供了类型检查，则必须接受字符串作为参数，如果不能处理字符串值，则引发 ValueError 或 TypeError。</p>
<p>如果一个元素带有一个 py: pytype 属性来表示它的数据类型，或者在没有这样一个属性的情况下，如果给定的类型检查调用在应用到元素文本时没有引发 ValueError/TypeError 异常，则使用 PyType。</p>
<p>如果需要，您还可以在 XML 架构类型名称下注册此类型：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xmas_type<span style="color: #666666">.</span>xmlSchemaTypes <span style="color: #666666">=</span> (<span style="color: #BA2121">&quot;date&quot;</span>,)
</code></pre></div>
<p>如果元素具有指定其数据类型的 <code>xsi:type</code> 属性，则将考虑 XML 架构类型。 上面的行将 <code>XSD</code> 类型日期绑定到新定义的 Python 类型。 请注意，这必须在下一步注册类型之前完成。 然后你就可以使用它：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xmas_type<span style="color: #666666">.</span>register()

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(
<span style="color: #000080; font-weight: bold">... </span>            <span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;24.12.2000&lt;/a&gt;&lt;b&gt;12.24.2000&lt;/b&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>call_santa()
<span style="color: #717171">Ho ho ho!</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>call_santa()
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: call_santa
</code></pre></div>
<p>如果需要指定类型检查函数之间的依赖关系，可以通过 <code>register()</code> 方法的 <code>before</code> 和 <code>after</code> 关键字参数传递一系列类型名称。 然后，<code>PyType</code> 将尝试在相应类型之前或之后注册自身，只要它们当前已注册即可。 请注意，这仅影响注册时当前注册的类型。 稍后注册的类型不会关心已注册类型的依赖关系。</p>
<p>如果您提供 XML Schema 类型信息，这将覆盖上面定义的类型检查函数：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">     &lt;a xsi:type=&quot;date&quot;&gt;12.24.2000&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a)
<span style="color: #717171">12.24.2000</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>call_santa()
<span style="color: #717171">Ho ho ho!</span>
</code></pre></div>
<p>要取消注册类型，请调用其 <code>unregister()</code> 方法：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>call_santa()
<span style="color: #717171">Ho ho ho!</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xmas_type<span style="color: #666666">.</span>unregister()
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>call_santa()
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: call_santa
</code></pre></div>
<p>但请注意，这并不立即适用于已经存在 Python 引用的元素。 只有在所有引用消失并且 Python 对象被垃圾收集后，它们的 Python 类才会被更改。</p>
</div>
<div class="tabbed-block">
<p><strong>Defining additional data classes</strong></p>
<p>You can plug additional data classes into objectify that will be used in exactly the same way as the predefined types. Data classes can either inherit from ObjectifiedDataElement directly or from one of the specialised classes like NumberElement or BoolElement. The numeric types require an initial call to the NumberElement method self._setValueParser(function) to set their type conversion function (string -&gt; numeric Python type). This call should be placed into the element _init() method.</p>
<p>The registration of data classes uses the PyType class:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ChristmasDate</span>(objectify<span style="color: #666666">.</span>ObjectifiedDataElement):
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">call_santa</span>(<span style="color: #008000">self</span>):
<span style="color: #000080; font-weight: bold">... </span>        <span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Ho ho ho!&quot;</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">checkChristmasDate</span>(date_string):
<span style="color: #000080; font-weight: bold">... </span>    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> date_string<span style="color: #666666">.</span>startswith(<span style="color: #BA2121">&#39;24.12.&#39;</span>):
<span style="color: #000080; font-weight: bold">... </span>        <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #CB3F38; font-weight: bold">ValueError</span> <span style="color: #3D7B7B; font-style: italic"># or TypeError</span>

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xmas_type <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>PyType(<span style="color: #BA2121">&#39;date&#39;</span>, checkChristmasDate, ChristmasDate)
</code></pre></div>
<p>The PyType constructor takes a string type name, an (optional) callable type check and the custom data class. If a type check is provided it must accept a string as argument and raise ValueError or TypeError if it cannot handle the string value.</p>
<p>PyTypes are used if an element carries a py:pytype attribute denoting its data type or, in absence of such an attribute, if the given type check callable does not raise a ValueError/TypeError exception when applied to the element text.</p>
<p>If you want, you can also register this type under an XML Schema type name:</p>
<p><div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xmas_type<span style="color: #666666">.</span>xmlSchemaTypes <span style="color: #666666">=</span> (<span style="color: #BA2121">&quot;date&quot;</span>,)
</code></pre></div>
XML Schema types will be considered if the element has an xsi:type attribute that specifies its data type. The line above binds the XSD type date to the newly defined Python type. Note that this must be done before the next step, which is to register the type. Then you can use it:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xmas_type<span style="color: #666666">.</span>register()

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(
<span style="color: #000080; font-weight: bold">... </span>            <span style="color: #BA2121">&quot;&lt;root&gt;&lt;a&gt;24.12.2000&lt;/a&gt;&lt;b&gt;12.24.2000&lt;/b&gt;&lt;/root&gt;&quot;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>call_santa()
<span style="color: #717171">Ho ho ho!</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>b<span style="color: #666666">.</span>call_santa()
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: call_santa
</code></pre></div>
<p>If you need to specify dependencies between the type check functions, you can pass a sequence of type names through the before and after keyword arguments of the register() method. The PyType will then try to register itself before or after the respective types, as long as they are currently registered. Note that this only impacts the currently registered types at the time of registration. Types that are registered later on will not care about the dependencies of already registered types.</p>
<p>If you provide XML Schema type information, this will override the type check function defined above:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>fromstring(<span style="color: #BA2121">&#39;&#39;&#39;</span><span style="color: #AA5D1F; font-weight: bold">\</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &lt;root xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">     &lt;a xsi:type=&quot;date&quot;&gt;12.24.2000&lt;/a&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &lt;/root&gt;</span>
<span style="color: #000080; font-weight: bold">... </span><span style="color: #BA2121">   &#39;&#39;&#39;</span>)
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span><span style="color: #008000">print</span>(root<span style="color: #666666">.</span>a)
<span style="color: #717171">12.24.2000</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>call_santa()
<span style="color: #717171">Ho ho ho!</span>
</code></pre></div>
<p>To unregister a type, call its unregister() method:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>call_santa()
<span style="color: #717171">Ho ho ho!</span>
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>xmas_type<span style="color: #666666">.</span>unregister()
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>root<span style="color: #666666">.</span>a<span style="color: #666666">.</span>call_santa()
<span style="color: #0044DD">Traceback (most recent call last):</span>
<span style="color: #bbbbbb">  </span><span style="color: #3D7B7B; font-style: italic">...</span>
<span style="color: #E40000">AttributeError</span>: no such child: call_santa
</code></pre></div>
<p>Be aware, though, that this does not immediately apply to elements to which there already is a Python reference. Their Python class will only be changed after all references are gone and the Python object is garbage collected.</p>
</div>
</div>
</div>
<h3 id="高级元素类查找">高级元素类查找<a class="headerlink" href="#高级元素类查找" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><input id="__tabbed_17_2" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">中文</label><label for="__tabbed_17_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>在某些情况下，正常的数据类设置是不够的。 然而，<code>lxml.objectify</code> 基于 <code>lxml.etree</code>，支持对树中使用的 <code>Element</code> 类进行非常细粒度的控制。 您所要做的就是配置一种不同的<a href="https://lxml.de/element_classes.html">类查找</a>机制（或自己编写一个）。</p>
<p>设置的第一步是创建一个新的解析器来构建对象化文档。 <strong>objectify API</strong> 适用于以数据为中心的 XML（而不是具有混合内容的文档 XML）。 因此，我们将解析器配置为让它从解析的文档中删除纯空白文本（如果该文本未包含在 XML 元素中）。 请注意，这会改变文档信息集，因此如果您将删除的空格视为特定用例中的数据，则应该使用普通的解析器并仅设置元素类查找。 然而，大多数应用程序都可以通过以下设置正常工作：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>parser <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>makeparser(remove_blank_text<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
</code></pre></div>
<p>它的内部作用是：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>parser <span style="color: #666666">=</span> etree<span style="color: #666666">.</span>XMLParser(remove_blank_text<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>lookup <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectifyElementClassLookup()
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>parser<span style="color: #666666">.</span>set_element_class_lookup(lookup)
</code></pre></div>
<p>如果您想更改查找方案，例如，获得对<a href="https://lxml.de/element_classes.html#namespace-class-lookup">命名空间特定类</a>的额外支持，您可以将 objectify 查找注册为后备 命名空间查找。 然而，在这种情况下，您必须注意命名空间类继承自 <code>objectify.ObjectifiedElement</code>，而不仅仅是普通的 <code>lxml.etree.ElementBase</code>，以便它们支持 <code>objectify API</code>。 上面的设置代码就变成了：</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>lookup <span style="color: #666666">=</span> etree<span style="color: #666666">.</span>ElementNamespaceClassLookup(
<span style="color: #000080; font-weight: bold">... </span>                  objectify<span style="color: #666666">.</span>ObjectifyElementClassLookup() )
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>parser<span style="color: #666666">.</span>set_element_class_lookup(lookup)
</code></pre></div>
<p>有关更多信息，请参阅有关<a href="https://lxml.de/element_classes.html">类查找</a>方案的文档。</p>
</div>
<div class="tabbed-block">
<p><strong>Advanced element class lookup</strong></p>
<p>In some cases, the normal data class setup is not enough. Being based on lxml.etree, however, lxml.objectify supports very fine-grained control over the Element classes used in a tree. All you have to do is configure a different <a href="https://lxml.de/element_classes.html">class lookup</a> mechanism (or write one yourself).</p>
<p>The first step for the setup is to create a new parser that builds objectify documents. The objectify API is meant for data-centric XML (as opposed to document XML with mixed content). Therefore, we configure the parser to let it remove whitespace-only text from the parsed document if it is not enclosed by an XML element. Note that this alters the document infoset, so if you consider the removed spaces as data in your specific use case, you should go with a normal parser and just set the element class lookup. Most applications, however, will work fine with the following setup:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>parser <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>makeparser(remove_blank_text<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
</code></pre></div>
<p>What this does internally, is:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>parser <span style="color: #666666">=</span> etree<span style="color: #666666">.</span>XMLParser(remove_blank_text<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)

<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>lookup <span style="color: #666666">=</span> objectify<span style="color: #666666">.</span>ObjectifyElementClassLookup()
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>parser<span style="color: #666666">.</span>set_element_class_lookup(lookup)
</code></pre></div>
<p>If you want to change the lookup scheme, say, to get additional support for <a href="https://lxml.de/element_classes.html#namespace-class-lookup">namespace specific classes</a>, you can register the objectify lookup as a fallback of the namespace lookup. In this case, however, you have to take care that the namespace classes inherit from objectify.ObjectifiedElement, not only from the normal lxml.etree.ElementBase, so that they support the objectify API. The above setup code then becomes:</p>
<div class="language-pycon highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>lookup <span style="color: #666666">=</span> etree<span style="color: #666666">.</span>ElementNamespaceClassLookup(
<span style="color: #000080; font-weight: bold">... </span>                  objectify<span style="color: #666666">.</span>ObjectifyElementClassLookup() )
<span style="color: #000080; font-weight: bold">&gt;&gt;&gt; </span>parser<span style="color: #666666">.</span>set_element_class_lookup(lookup)
</code></pre></div>
<p>See the documentation on <a href="https://lxml.de/element_classes.html">class lookup</a> schemes for more information.</p>
</div>
</div>
</div>
<h2 id="与-lxmletree-有什么不同">与 lxml.etree 有什么不同？<a class="headerlink" href="#与-lxmletree-有什么不同" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><input id="__tabbed_18_2" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">中文</label><label for="__tabbed_18_2">英文</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>这种不同的 Element API 显然意味着对 API 其余部分的正常行为有一些副作用。</p>
<ul>
<li><code>len(&lt;element&gt;)</code> 返回同级计数，而不是 <code>&lt;element&gt;</code> 的子级数量。 您可以使用<code>countchildren()</code>方法检索子级的数量。</li>
<li>元素的迭代不会产生子元素，而是产生兄弟元素。 您可以使用元素上的<code>iterchildren()</code>方法访问所有子项，或通过调用<code>getchildren()</code>方法检索列表。</li>
<li><code>find</code>、<code>findall</code> 和 <code>findtext</code> 方法需要基于 <code>ETXPath</code> 的不同实现。 在<code>lxml.etree</code>中，他们使用基于原始迭代方案的Python实现。 这样做的缺点是它们可能无法 100% 向后兼容，另外的优点是它们现在支持任何 <code>XPath</code> 表达式。</li>
</ul>
</div>
<div class="tabbed-block">
<p><strong>What is different from lxml.etree?</strong></p>
<p>Such a different Element API obviously implies some side effects to the normal behaviour of the rest of the API.</p>
<ul>
<li><code>len(&lt;element&gt;)</code> returns the sibling count, not the number of children of <code>&lt;element&gt;</code>. You can retrieve the number of children with the <code>countchildren()</code> method.</li>
<li>Iteration over elements does not yield the children, but the siblings. You can access all children with the <code>iterchildren()</code> method on elements or retrieve a list by calling the <code>getchildren()</code> method.</li>
<li>The find, findall and findtext methods require a different implementation based on ETXPath. In <code>lxml.etree</code>, they use a Python implementation based on the original iteration scheme. This has the disadvantage that they may not be 100% backwards compatible, and the additional advantage that they now support any XPath expression.</li>
</ul>
</div>
</div>
</div>

  <hr>
<div class="md-source-file">
  <small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年4月11日</span>
      
        <br>
        创建日期:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2024年4月11日</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "content.tabs.link", "content.code.copy", "content.tooltips", "navigation.indexes", "navigation.prune", "navigation.instant"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.94c44541.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>